<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="vn.com.irtech.eport.equipment.mapper.EquipmentDoMapper">
    
    <resultMap type="EquipmentDo" id="EquipmentDoResult">
        <result property="id"    column="id"    />
        <result property="carrierId"    column="carrier_id"    />
        <result property="carrierCode"    column="carrier_code"    />
        <result property="orderNumber"    column="order_number"    />
        <result property="billOfLading"    column="bill_of_lading"    />
        <result property="businessUnit"    column="business_unit"    />
        <result property="consignee"    column="consignee"    />
        <result property="containerNumber"    column="container_number"    />
        <result property="expiredDem"    column="expired_dem"    />
        <result property="emptyContainerDepot"    column="empty_container_depot"    />
        <result property="detFreeTime"    column="det_free_time"    />
        <result property="secureCode"    column="secure_code"    />
        <result property="releaseDate"    column="release_date"    />
        <result property="vessel"    column="vessel"    />
        <result property="voyNo"    column="voy_no"    />
        <result property="doType"    column="do_type"    />
        <result property="status"    column="status"    />
        <result property="processStatus"    column="process_status"    />
        <result property="documentStatus"    column="document_status"    />
        <result property="documentReceiptDate"    column="document_receipt_date"    />
        <result property="releaseStatus"    column="release_status"    />
        <result property="createSource"    column="create_source"    />
        <result property="remark"    column="remark"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
        <result property="processRemark"    column="process_remark"    />
        <result property="newExpiredDem"    column="new_expired_dem"    />
        <result property="weight"    column="weight"    />
        <result property="sealNo"    column="seal_no"    />
    </resultMap>

    <resultMap type="String" id="ContainerNumberListResult">
        <result property="containerNumber"    column="container_number"    />
    </resultMap>

    <sql id="selectEquipmentDoVo">
        select id, carrier_id, carrier_code, order_number, bill_of_lading, business_unit, consignee, container_number, expired_dem, empty_container_depot, det_free_time, secure_code, release_date, vessel, voy_no, do_type, status, process_status, document_status, document_receipt_date, release_status, create_source, remark, create_by, create_time, update_by, update_time, process_remark,new_expired_dem, weight, seal_no from equipment_do
    </sql>
    <select id="selectEquipmentDoListPagingAdmin" parameterType="equipmentDo" resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        <where>  
            <if test="expiredDemStartDay != null"> and expired_dem = #{expiredDemStartDay} OR expired_dem > #{expiredDemStartDay}</if>
            <if test="expiredDemEndDay != null"> and expired_dem = #{expiredDemEndDay} OR expired_dem &lt; #{expiredDemEndDay}</if>
            <if test="billOfLading != null  and billOfLading != ''"> and bill_of_lading = #{billOfLading}</if>
            <if test="orderNumber != null  and orderNumber != ''"> and order_number = #{orderNumber}</if>
            <if test="carrierCode != null  and carrierCode != ''"> and carrier_code like concat(concat('%',#{carrierCode}),'%')</if>
            <if test="consignee != null  and consignee != ''"> and consignee like concat(concat('%',#{consignee}),'%')</if>
            <if test="containerNumber != null  and containerNumber != ''"> and container_number like concat(concat('%',#{containerNumber}),'%')</if>
            <if test="emptyContainerDepot != null  and emptyContainerDepot != ''"> and empty_container_depot = #{emptyContainerDepot}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no like concat(concat('%',#{voyNo}),'%')</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="detFreeTime != null  and detFreeTime != ''"> and det_free_time = #{detFreeTime}</if>
            <if test="documentReceiptDate != null "> and document_receipt_date = #{documentReceiptDate}</if>
            <if test="releaseStatus != null  and releaseStatus != ''"> and release_status = #{releaseStatus}</if>
            <if test="documentStatus != null  and documentStatus != ''"> and document_status = #{documentStatus}</if>
            <if test="createSource != null  and createSource != ''"> and create_source = #{createSource}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="vessel != null  and vessel != ''"> and lower(vessel) like concat(concat('%',#{vessel}),'%')</if>
            <if test="expiredDemStartDay != null"> and expired_dem BETWEEN #{expiredDemStartDay} AND #{expiredDemEndDay}</if>
        </where> 
    </select>
    <select id="selectEquipmentDoListPagingCarrier" parameterType="equipmentDo" resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        <where> 
            <if test="billOfLading != null  and billOfLading != ''"> and bill_of_lading = #{billOfLading}</if>
            <if test="carrierCode != null  and carrierCode != ''"> and carrier_code = #{carrierCode}</if>
            <if test="orderNumber != null  and orderNumber != ''"> and order_number = #{orderNumber}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="containerNumber != null  and containerNumber != ''"> and container_number = #{containerNumber}</if>
            <if test="emptyContainerDepot != null  and emptyContainerDepot != ''"> and empty_container_depot = #{emptyContainerDepot}</if>
            <if test="expiredDem != null"> and expired_dem = #{expiredDem}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="detFreeTime != null  and detFreeTime != ''"> and det_free_time = #{detFreeTime}</if>
            <if test="documentReceiptDate != null "> and document_receipt_date = #{documentReceiptDate}</if>
            <if test="releaseStatus != null  and releaseStatus != ''"> and release_status = #{releaseStatus}</if>
            <if test="createSource != null  and createSource != ''"> and create_source = #{createSource}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="vessel != null  and vessel != ''"> and vessel = #{vessel}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
        </where>
        ORDER BY id DESC 
        OFFSET #{page} ROWS FETCH NEXT #{10} ROWS ONLY 
    </select>
    <select id="selectEquipmentDoDetails" parameterType="EquipmentDo"  resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        <where>
            <if test="fromDate != null"> and expired_dem between #{fromDate} and #{toDate}</if>
            <if test="fromDate != null"> and expired_dem = #{fromDate} OR expired_dem > #{fromDate}</if>
            <if test="toDate != null"> and expired_dem = #{toDate} OR expired_dem &lt; #{toDate}</if> 
            <if test="billOfLading != null  and billOfLading != ''"> and bill_of_lading = #{billOfLading}</if>  
            <if test="carrierId != null  and carrierId != ''"> and carrier_id = #{carrierId}</if>
            <if test="carrierCode != null  and carrierCode != ''"> and carrier_code = #{carrierCode}</if>
            <if test="orderNumber != null  and orderNumber != ''"> and order_number = #{orderNumber}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="containerNumber != null  and containerNumber != ''"> and lower(container_number) like concat(concat('%', #{containerNumber}), '%')</if>
            <if test="emptyContainerDepot != null  and emptyContainerDepot != ''"> and empty_container_depot = #{emptyContainerDepot}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="detFreeTime != null  and detFreeTime != ''"> and det_free_time = #{detFreeTime}</if>
            <if test="documentReceiptDate != null "> and document_receipt_date = #{documentReceiptDate}</if>
            <if test="releaseStatus != null  and releaseStatus != ''"> and release_status = #{releaseStatus}</if>
            <if test="createSource != null  and createSource != ''"> and create_source = #{createSource}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="vessel != null  and vessel != ''"> and vessel = #{vessel}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no like concat(concat('%', #{voyNo}), '%')</if>
        </where>
        ORDER BY id DESC  
    </select>
    <select id="selectEquipmentDoList" parameterType="EquipmentDo"  resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        <where>
            <if test="fromDate != null"> and expired_dem between #{fromDate} and #{toDate}</if>
            <if test="fromDate != null"> and expired_dem = #{fromDate} OR expired_dem > #{fromDate}</if>
            <if test="toDate != null"> and expired_dem = #{toDate} OR expired_dem &lt; #{toDate}</if> 
            <if test="billOfLading != null  and billOfLading != ''"> and bill_of_lading like concat(concat('%', #{billOfLading}), '%')</if>  
            <if test="carrierId != null  and carrierId != ''"> and carrier_id = #{carrierId}</if>
            <if test="carrierCode != null  and carrierCode != ''"> and carrier_code = #{carrierCode}</if>
            <if test="orderNumber != null  and orderNumber != ''"> and order_number = #{orderNumber}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="containerNumber != null  and containerNumber != ''"> and container_number like concat(concat('%', #{containerNumber}), '%')</if>
            <if test="emptyContainerDepot != null  and emptyContainerDepot != ''"> and empty_container_depot = #{emptyContainerDepot}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="detFreeTime != null  and detFreeTime != ''"> and det_free_time = #{detFreeTime}</if>
            <if test="documentReceiptDate != null "> and document_receipt_date = #{documentReceiptDate}</if>
            <if test="releaseStatus != null  and releaseStatus != ''"> and release_status = #{releaseStatus}</if>
            <if test="createSource != null  and createSource != ''"> and create_source = #{createSource}</if>
            <if test="businessUnit != null  and businessUnit != ''"> and business_Unit = #{businessUnit}</if>
            <if test="vessel != null  and vessel != ''"> and vessel = #{vessel}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no like concat(concat('%', #{voyNo}), '%')</if>
        </where>
        ORDER BY id DESC  
    </select>
    <select id="selectEquipmentDoListExclusiveBill" parameterType="EquipmentDo"  resultMap="EquipmentDoResult">
        select max(carrier_id) as carrier_id, max(carrier_code) as carrier_code, max(order_number) as order_number, 
        bill_of_lading, max(business_unit) as business_unit, max(consignee) as consignee, max(expired_dem) as expired_dem, 
        max(empty_container_depot) as empty_container_depot, max(det_free_time) as det_free_time, max(secure_code) as secure_code, 
        max(release_date) as release_date, max(vessel) as vessel, max(voy_no) as voy_no, max(do_type) as do_type, max(status) as status, 
        max(process_status) as process_status, max(document_status) as document_status, max(document_receipt_date) as document_receipt_date, 
        max(release_status) as release_status, max(create_source) as create_source, max(remark) as remark, max(create_by) as create_by, 
        max(create_time) as create_time, max(update_by) as update_by, max(update_time) as update_time, max(process_remark) as process_remark, 
        max(new_expired_dem) as new_expired_dem, max(weight) as weight, max(seal_no) as seal_no
        from equipment_do
        <where>
            <if test="billOfLading != null  and billOfLading != ''"> and bill_of_lading like concat(concat('%', #{billOfLading}), '%')</if>  
            <if test="carrierId != null  and carrierId != ''"> and carrier_id = #{carrierId}</if>
            <if test="carrierCode != null  and carrierCode != ''"> and lower(carrier_code) like concat(concat('%', #{carrierCode}), '%')</if>
            <if test="orderNumber != null  and orderNumber != ''"> and order_number = #{orderNumber}</if>
            <if test="consignee != null  and consignee != ''"> and lower(consignee) like concat(concat('%', #{consignee}), '%')</if>
            <if test="containerNumber != null  and containerNumber != ''"> and container_number like concat(concat('%', #{containerNumber}), '%')</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="documentStatus != null  and documentStatus != ''"> and document_status = #{documentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="releaseStatus != null  and releaseStatus != ''"> and release_status = #{releaseStatus}</if>
            <if test="createSource != null  and createSource != ''"> and create_source = #{createSource}</if>
            <if test="vessel != null  and vessel != ''"> and lower(vessel) like concat(concat('%', #{vessel}), '%')</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no like concat(concat('%', #{voyNo}), '%')</if>
            <if test="fromDate != null">AND create_time &gt;= #{documentReceifromDateptDate}</if>
			<if test="toDate != null">AND create_time &lt;= #{toDate}</if>
            <if test="fromDate != null"> and create_time between #{fromDate} and #{toDate}</if>
        </where>
        GROUP BY bill_of_lading
        ORDER BY create_time DESC 
    </select>
    <select id="selectEquipmentDoListAdmin" parameterType="int" resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>   
        ORDER BY id DESC  
        OFFSET #{page.offset} ROWS FETCH NEXT #{10} ROWS ONLY
    </select>
    <select id="selectEquipmentDoById" parameterType="Long" resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        where id = #{id}
    </select>
        
    <insert id="insertEquipmentDo" parameterType="EquipmentDo" useGeneratedKeys="true" keyProperty="id">
        <selectKey keyProperty="id" order="BEFORE" resultType="Long">
                select seq_equipment_do.nextval as id from DUAL
        </selectKey>
            insert into equipment_do
            <trim prefix="(" suffix=")" suffixOverrides=",">
                <if test="id != null and id != 0 ">id,</if>
                <if test="carrierId != null ">carrier_id,</if>
                <if test="carrierCode != null  and carrierCode != ''">carrier_code,</if>
                <if test="orderNumber != null  and orderNumber != ''">order_number,</if>
                <if test="billOfLading != null  and billOfLading != ''">bill_of_lading,</if>
                <if test="businessUnit != null  and businessUnit != ''">business_unit,</if>
                <if test="consignee != null  and consignee != ''">consignee,</if>
                <if test="containerNumber != null  and containerNumber != ''">container_number,</if>
                <if test="expiredDem != null">expired_dem,</if>
                <if test="emptyContainerDepot != null  and emptyContainerDepot != ''">empty_container_depot,</if>
                <if test="detFreeTime != null ">det_free_time,</if>
                <if test="secureCode != null  and secureCode != ''">secure_code,</if>
                <if test="releaseDate != null">release_date,</if>
                <if test="vessel != null  and vessel != ''">vessel,</if>
                <if test="voyNo != null  and voyNo != ''">voy_no,</if>
                <if test="doType != null  and doType != ''">do_type,</if>
                <if test="status != null  and status != ''">status,</if>
                <if test="processStatus != null  and processStatus != ''">process_status,</if>
                <if test="documentStatus != null  and documentStatus != ''">document_status,</if>
                <if test="documentReceiptDate != null ">document_receipt_date,</if>
                <if test="releaseStatus != null  and releaseStatus != ''">release_status,</if>
                <if test="createSource != null  and createSource != ''">create_source,</if>
                <if test="remark != null  and remark != ''">remark,</if>
                <if test="weight != null  and weight != ''">weight,</if>
                <if test="sealNo != null  and sealNo != ''">seal_no,</if>
                <if test="createBy != null  and createBy != ''">create_by,</if>
                create_time
            </trim>
            <trim prefix="values (" suffix=")" suffixOverrides=",">
                <if test="id != null and id != 0 ">#{id},</if>
                <if test="carrierId != null ">#{carrierId},</if>
                <if test="carrierCode != null  and carrierCode != ''">#{carrierCode},</if>
                <if test="orderNumber != null  and orderNumber != ''">#{orderNumber},</if>
                <if test="billOfLading != null  and billOfLading != ''">#{billOfLading},</if>
                <if test="businessUnit != null  and businessUnit != ''">#{businessUnit},</if>
                <if test="consignee != null  and consignee != ''">#{consignee},</if>
                <if test="containerNumber != null  and containerNumber != ''">#{containerNumber},</if>
                <if test="expiredDem != null">#{expiredDem},</if>
                <if test="emptyContainerDepot != null  and emptyContainerDepot != ''">#{emptyContainerDepot},</if>
                <if test="detFreeTime != null ">#{detFreeTime},</if>
                <if test="secureCode != null  and secureCode != ''">#{secureCode},</if>
                <if test="releaseDate != null">#{releaseDate},</if>
                <if test="vessel != null  and vessel != ''">#{vessel},</if>
                <if test="voyNo != null  and voyNo != ''">#{voyNo},</if>
                <if test="doType != null  and doType != ''">#{doType},</if>
                <if test="status != null  and status != ''">#{status},</if>
                <if test="processStatus != null  and processStatus != ''">#{processStatus},</if>
                <if test="documentStatus != null  and documentStatus != ''">#{documentStatus},</if>
                <if test="documentReceiptDate != null">#{documentReceiptDate},</if>
                <if test="releaseStatus != null  and releaseStatus != ''">#{releaseStatus},</if>
                <if test="createSource != null  and createSource != ''">#{createSource},</if>
                <if test="remark != null  and remark != ''">#{remark},</if>
                <if test="weight != null  and weight != ''">#{weight},</if>
                <if test="sealNo != null  and sealNo != ''">#{sealNo},</if>
                <if test="createBy != null  and createBy != ''">#{createBy},</if>
                sysdate
            </trim>
    </insert>

    <update id="updateEquipmentDo" parameterType="EquipmentDo">
        update equipment_do
        <trim prefix="SET" suffixOverrides=",">
            <if test="carrierId != null ">carrier_id = #{carrierId},</if>
            <if test="carrierCode != null  and carrierCode != ''">carrier_code = #{carrierCode},</if>
            <if test="orderNumber != null  and orderNumber != ''">order_number = #{orderNumber},</if>
            <if test="billOfLading != null  and billOfLading != ''">bill_of_lading = #{billOfLading},</if>
            <if test="businessUnit != null  and businessUnit != ''">business_unit = #{businessUnit},</if>
            <if test="consignee != null  and consignee != ''">consignee = #{consignee},</if>
            <if test="containerNumber != null  and containerNumber != ''">container_number = #{containerNumber},</if>
            <if test="expiredDem != null">expired_dem = #{expiredDem},</if>
            <if test="emptyContainerDepot != null  and emptyContainerDepot != ''">empty_container_depot = #{emptyContainerDepot},</if>
            <if test="detFreeTime != null ">det_free_time = #{detFreeTime},</if>
            <if test="secureCode != null  and secureCode != ''">secure_code = #{secureCode},</if>
            <if test="releaseDate != null">release_date = #{releaseDate},</if>
            <if test="vessel != null  and vessel != ''">vessel = #{vessel},</if>
            <if test="voyNo != null  and voyNo != ''">voy_no = #{voyNo},</if>
            <if test="doType != null  and doType != ''">do_type = #{doType},</if>
            <if test="status != null  and status != ''">status = #{status},</if>
            <if test="processStatus != null  and processStatus != ''">process_status = #{processStatus},</if>
            <if test="documentStatus != null  and documentStatus != ''">document_status = #{documentStatus},</if>
            <choose>
            <when test="documentReceiptDate != null">
              document_receipt_date = #{documentReceiptDate},
            </when>
            <otherwise>
                document_receipt_date = NULL,
            </otherwise>
            </choose>
            <if test="releaseStatus != null  and releaseStatus != ''">release_status = #{releaseStatus},</if>
            <if test="createSource != null  and createSource != ''">create_source = #{createSource},</if>
            <if test="remark != null  and remark != ''">remark = #{remark},</if>
            <if test="updateBy != null  and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate
        </trim>
        where id = #{id}
    </update>
    
    <update id="updateBillOfLading" parameterType="EquipmentDo">
        update equipment_do
        <trim prefix="SET" suffixOverrides=",">
            <if test="status != null  and status != ''">status = #{status},</if>
            <if test="processStatus != null  and processStatus != ''">process_status = #{processStatus},</if>
            <if test="documentStatus != null  and documentStatus != ''">document_status = #{documentStatus},</if>
            <if test="updateBy != null  and updateBy != ''">update_by = #{updateBy},</if>
            <if test="processRemark != null  and processRemark != ''">process_remark = #{processRemark},</if>
            <if test="documentReceiptDate != null">document_receipt_date = #{documentReceiptDate},</if>
            update_time = sysdate
        </trim>
        where bill_of_lading = #{billOfLading}
    </update>

    <update id="updateEquipmentDoExpiredDem" parameterType="EquipmentDo">
        update equipment_do
        <trim prefix="SET" suffixOverrides=",">
            <if test="newExpiredDem != null ">new_expired_dem = #{newExpiredDem},</if>
            <if test="releaseStatus != null  and releaseStatus != ''">release_status = #{releaseStatus},</if>
            <if test="createSource != null  and createSource != ''">create_source = #{createSource},</if>
            <if test="remark != null  and remark != ''">remark = #{remark},</if>
            <if test="updateBy != null  and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate
        </trim>
        where bill_of_lading = #{billOfLading}
    </update>
    
    <delete id="deleteEquipmentDoById" parameterType="Long">
        delete from equipment_do where id = #{id}
    </delete>

    <delete id="deleteEquipmentDoByIds" parameterType="String">
        delete from equipment_do where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
    
    <select id="getContainerNumberById" parameterType="Long" resultType="String">
      select container_number from equipment_do where id = #{id}
    </select>

    <select id="getContainerNumberListByIds" parameterType="String" resultMap="ContainerNumberListResult">
      select container_number from equipment_do where id in
      <foreach item="id" collection="array" open="(" separator="," close=")">
        #{id}
      </foreach>
    </select>
    <select id="getDocumentReceiptDate" parameterType="Long" resultType="Date">
        select document_receipt_date from equipment_do where id = #{id}
    </select>
    
    <select id="getStatus" parameterType="Long" resultType="String">
        select status from equipment_do where id = #{id}
    </select>
    <select id="getContainerListByIds" parameterType="String" resultMap="EquipmentDoResult">
      select bill_of_lading, container_number, vessel, expired_dem from equipment_do where id in
      <foreach item="id" collection="array" open="(" separator="," close=")">
        #{id}
      </foreach>
    </select>
     <select id="getTotalPagesCont" parameterType="String" resultType="Long">
		select count(*) from equipment_do where bill_of_lading=#{billOfLading}
	</select>
    <select id="countContainerNumber" parameterType="String" resultType="String">
		select count(*) from equipment_do where bill_of_lading=#{billOfLading}
	</select>
	
	<select id="getReportByCarrierGroup" parameterType="String" resultType="hashmap">
		SELECT 
			(SELECT COUNT(DISTINCT bill_of_lading) FROM equipment_do where carrier_code in 
		        <foreach item="id" collection="array" open="(" separator="," close=")">
		            #{id}
		        </foreach>
        		) AS totalBl,
			(SELECT COUNT(container_number) FROM equipment_do where carrier_code in 
		        <foreach item="id" collection="array" open="(" separator="," close=")">
		            #{id}
		        </foreach>
		        ) AS totalCont,
			(SELECT COUNT(DISTINCT bill_of_lading) FROM equipment_do  where carrier_code in 
		        <foreach item="id" collection="array" open="(" separator="," close=")">
		            #{id}
		        </foreach>
		        AND process_status = 0) AS waitingBl,
			(SELECT COUNT(DISTINCT bill_of_lading) FROM equipment_do where carrier_code in 
		        <foreach item="id" collection="array" open="(" separator="," close=")">
		            #{id}
		        </foreach>
		        AND process_status = 1) AS completedBl
            from equipment_do
	</select>
	
	<select id="getReportForAdmin" parameterType="String" resultType="hashmap">
		SELECT 
			(SELECT COUNT(DISTINCT bill_of_lading) FROM equipment_do) AS totalBl,
			(SELECT COUNT(container_number) FROM equipment_do)        AS totalCont,
			(SELECT COUNT(DISTINCT bill_of_lading) FROM equipment_do where process_status = 0) AS waitingBl,
			(SELECT COUNT(DISTINCT bill_of_lading) FROM equipment_do where process_status = 1) AS completedBl
        from equipment_do
	</select>
	
	<select id="selectBillOfLadingInfo" parameterType="String" resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        WHERE bill_of_lading = #{blNo}
        FETCH NEXT 1 ROWS ONLY
    </select>

    <select id="countDOStatusYes" parameterType="String" resultType="int">
            select count(*) from equipment_do where bill_of_lading=#{billOfLading} AND status = 1
    </select>
    <select id="countDocmentStatusYes" parameterType="String" resultType="int">
            select count(*) from equipment_do where bill_of_lading=#{billOfLading} AND document_status = 1
    </select>
    <select id="selectEquipmentDoVoByBillNo" parameterType="String" resultMap="EquipmentDoResult">
        <include refid="selectEquipmentDoVo"/>
        where bill_of_lading = #{blNo}
    </select>

    <select id="getConsignee" parameterType="Long" resultType="String">
      select DISTINCT consignee from equipment_do where carrier_id = #{id}
    </select>

    <select id="getVessel" parameterType="Long" resultType="String">
      select DISTINCT vessel from equipment_do where carrier_id = #{id}
    </select>

    <select id="getEmptyContainerDepot" parameterType="Long" resultType="String">
      select DISTINCT empty_container_depot from equipment_do where carrier_id = #{id}
    </select>
</mapper>