<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="vn.com.irtech.eport.logistic.mapper.ShipmentMapper">
    
    <resultMap type="Shipment" id="ShipmentResult">
        <result property="id"    column="id"    />
        <result property="logisticAccountId"    column="logistic_account_id"    />
        <result property="logisticGroupId"    column="logistic_group_id"    />
        <result property="serviceType"    column="service_type"    />
        <result property="blNo"    column="bl_no"    />
        <result property="bookingNo"    column="booking_no"    />
        <result property="opeCode"    column="ope_code"    />
        <result property="containerAmount"    column="container_amount"    />
        <result property="edoFlg"    column="edo_flg"    />
        <result property="specificContFlg"    column="specific_cont_flg"    />
        <result property="contSupplyStatus"    column="cont_supply_status"    />
        <result property="status"    column="status"    />
        <result property="remark"    column="remark"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
        <result property="logisticName"    column="logistic_name"    />
        <result property="vslNm"    column="vsl_nm"    />
        <result property="voyNo"    column="voy_no"    />
        <result property="orderNumber"    column="order_number"    />
        <result property="houseBill"    column="house_bill"    />
        <result property="amountBill"    column="amount_bill"    />
        <result property="sendContEmptyType"    column="send_cont_empty_type"    />
        <result property="consignee"    column="consignee"    />
        <result property="sztp"    column="sztp"    />
        
    </resultMap>
    <sql id="selectShipmentVo">
        select id, logistic_account_id, logistic_group_id, service_type, bl_no, booking_no, ope_code, container_amount, edo_flg, specific_cont_flg, cont_supply_status,  status, remark, order_number, house_bill, send_cont_empty_type, create_by, create_time, update_by, update_time from shipment
    </sql>

    <select id="selectShipmentList" parameterType="Shipment" resultMap="ShipmentResult">
        <include refid="selectShipmentVo"/>
        <where>  
            <if test="id != null "> and id = #{id}</if>
            <if test="logisticAccountId != null "> and logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="serviceType != null "> and service_type = #{serviceType}</if>
            <if test="blNo != null and blNo != ''"> and upper(bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="remark != null  and remark != ''"> and remark = #{remark}</if>
            <if test="fromDate != null">and create_time &gt;= #{fromDate}</if>
            <if test="toDate != null">and create_time &lt;= #{toDate}</if>
        </where>
        order by create_time desc
    </select>
    
    <select id="selectShipmentById" parameterType="Long" resultMap="ShipmentResult">
        <include refid="selectShipmentVo"/>
        where id = #{id}
    </select>
        
    <insert id="insertShipment" parameterType="Shipment" useGeneratedKeys="true" keyProperty="id">
        <selectKey keyProperty="id" order="BEFORE" resultType="Long">
			select seq_shipment.nextval as id from DUAL
		</selectKey>
        insert into shipment
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null and id != 0">id,</if>
            <if test="logisticAccountId != null ">logistic_account_id,</if>
            <if test="logisticGroupId != null ">logistic_group_id,</if>
            <if test="serviceType != null ">service_type,</if>
            <if test="blNo != null  and blNo != ''">bl_no,</if>
            <if test="bookingNo != null  and bookingNo != ''">booking_no,</if>
            <if test="opeCode != null  and opeCode != ''">ope_code,</if>
            <if test="containerAmount != null ">container_amount,</if>
            <if test="edoFlg != null  and edoFlg != ''">edo_flg,</if>
            <if test="specificContFlg != null">specific_cont_flg,</if>
            <if test="contSupplyStatus != null">cont_supply_status,</if>
            <if test="status != null  and status != ''">status,</if>
            <if test="orderNumber != null  and orderNumber != ''">order_number,</if>
            <if test="houseBill != null  and houseBill != ''">house_bill,</if>
            <if test="sendContEmptyType != null  and sendContEmptyType != ''">send_cont_empty_type,</if>
            <if test="remark != null  and remark != ''">remark,</if>
            <if test="createBy != null  and createBy != ''">create_by,</if>
            create_time
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
 			<if test="id != null">#{id},</if>
            <if test="logisticAccountId != null ">#{logisticAccountId},</if>
            <if test="logisticGroupId != null ">#{logisticGroupId},</if>
            <if test="serviceType != null ">#{serviceType},</if>
            <if test="blNo != null  and blNo != ''">trim(upper(#{blNo})),</if>
            <if test="bookingNo != null  and bookingNo != ''">trim(upper(#{bookingNo})),</if>
            <if test="opeCode != null  and opeCode != ''">#{opeCode},</if>
            <if test="containerAmount != null ">#{containerAmount},</if>
            <if test="edoFlg != null  and edoFlg != ''">#{edoFlg},</if>
            <if test="specificContFlg != null">#{specificContFlg},</if>
            <if test="contSupplyStatus != null">#{contSupplyStatus},</if>
            <if test="status != null  and status != ''">#{status},</if>
            <if test="orderNumber != null  and orderNumber != ''">#{orderNumber},</if>
            <if test="houseBill != null  and houseBill != ''">#{houseBill},</if>
            <if test="sendContEmptyType != null  and sendContEmptyType != ''">#{sendContEmptyType},</if>
            <if test="remark != null  and remark != ''">#{remark},</if>
            <if test="createBy != null  and createBy != ''">#{createBy},</if>
            sysdate
         </trim>
    </insert>

    <update id="updateShipment" parameterType="Shipment">
        update shipment
        <trim prefix="SET" suffixOverrides=",">
            <if test="logisticAccountId != null ">logistic_account_id = #{logisticAccountId},</if>
            <if test="logisticGroupId != null ">logistic_group_id = #{logisticGroupId},</if>
            <if test="serviceType != null ">service_type = #{serviceType},</if>
            <if test="blNo != null">bl_no = trim(upper(#{blNo})),</if>
            <if test="bookingNo != null">booking_no = trim(upper(#{bookingNo})),</if>
            <if test="opeCode != null  and opeCode != ''">ope_code = #{opeCode},</if>
            <if test="containerAmount != null ">container_amount = #{containerAmount},</if>
            <if test="edoFlg != null  and edoFlg != ''">edo_flg = #{edoFlg},</if>
            <if test="specificContFlg != null">specific_cont_flg = #{specificContFlg},</if>
            <if test="contSupplyStatus != null">cont_supply_status = #{contSupplyStatus},</if>
            <if test="status != null  and status != ''">status = #{status},</if>
            <if test="orderNumber != null  and orderNumber != ''">order_number = #{orderNumber},</if>
            <if test="houseBill != null  and houseBill != ''">house_bill = #{houseBill},</if>
            <if test="sendContEmptyType != null  and sendContEmptyType != ''">send_cont_empty_type = #{sendContEmptyType},</if>
            <if test="remark != null">remark = #{remark},</if>
            <if test="updateBy != null  and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteShipmentById" parameterType="Long">
        delete from shipment where id = #{id}
    </delete>

    <delete id="deleteShipmentByIds" parameterType="String">
        delete from shipment where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="checkBillBookingNoUnique" parameterType="Shipment" resultType="int">
        select count(*) from shipment
        <where>  
            <if test="serviceType != null "> and service_type = #{serviceType}</if>
            <if test="blNo != null and blNo != ''">
                and ((bl_no = #{blNo} and house_bill is null) or (house_bill = #{blNo}))
            </if>
            <if test="bookingNo != null and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="logisticGroupId != null"> and logistic_group_id = #{logisticGroupId}</if>
        </where>
    </select>

    <select id="selectShipmentListForOm" parameterType="Shipment" resultMap="ShipmentResult">
        select id, logistic_account_id, logistic_group_id, service_type, bl_no, booking_no, status, create_time, 
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as logistic_name,
        (select sh.vsl_nm from shipment_detail sh where sh.shipment_id = s.id FETCH NEXT 1 ROWS ONLY) as vsl_nm,
        (select sh.voy_no from shipment_detail sh where sh.shipment_id = s.id FETCH NEXT 1 ROWS ONLY) as voy_no,
        (select count(*) from shipment_detail sh where sh.shipment_id = s.id) as container_amount,
        (select count(*) from process_bill b left join process_order o on b.process_order_id = o.id where b.shipment_id = s.id) as amount_bill
        from shipment s
        <where>
            status != 1
            and status != 4
            <if test="id != null "> and s.id = #{id}</if>
            <if test="serviceType != null "> and service_type = #{serviceType}</if>
            <if test="logisticGroupId != null and logisticGroupId != ''"> and logistic_group_id = #{logisticGroupId}</if>
            <if test="fromDate != null">and s.create_time &gt;= #{fromDate}</if>
            <if test="toDate != null">and s.create_time &lt;= #{toDate}</if>
            <if test="containerAmount != null">and s.container_amount = #{containerAmount}</if>
            <if test="blNo != null and blNo != ''"> and (upper(bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> or upper(booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
        </where>
        GROUP BY id, logistic_account_id, logistic_group_id, service_type, bl_no, booking_no, status, create_time
        order by create_time desc
    </select>

    <select id="getShipmentListForAssign" parameterType="Shipment" resultMap="ShipmentResult">
        select * from (
            select  s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code,
                s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.create_by, s.create_time, s.update_by, s.update_time,
                (select sh.consignee from shipment_detail sh where sh.shipment_id = s.id fetch next 1 rows only) as consignee,
                (select count(*) from shipment_detail sh where sh.shipment_id = s.id and sh.payment_status = 'Y') as container_amount
            from shipment s right join shipment_detail sh on s.id = sh.shipment_id
            <where>
                s.container_amount > 0
                <if test="containerAmount != null "> and container_amount > 0</if>
                <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
                <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
                <if test="serviceType != null "> and s.service_type = #{serviceType}</if>
                <if test="blNo != null and blNo != ''"> and s.bl_no = #{blNo}</if>
                <if test="bookingNo != null and bookingNo != ''"> and s.booking_no = #{bookingNo}</if>
                <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
                <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
                <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
                <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
                <if test="status != null  and status != ''"> and s.status = #{status}</if>
                <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
                <if test="params.containerNo != null  and params.containerNo != ''"> and upper(sh.container_no) like concat(concat('%', #{params.containerNo}), '%')</if>
                <if test="params.consignee != null  and params.consignee != ''"> and upper(sh.consignee) like concat(concat('%', #{params.consignee}), '%')</if>
                <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
                <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
                <if test="params.blOrBooking != null and params.blOrBooking != ''">
                    and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
                </if>
            </where>
            group by s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code,
            s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.create_by, s.create_time, s.update_by, s.update_time
        ) 
        where container_amount > 0
        order by create_time desc
    </select>

    <select id="selectShipmentListForDriver" resultType="vn.com.irtech.eport.logistic.form.ShipmentForm">
        select s.id as batchId, s.bl_no as blNo, s.booking_no as bookingNo, sh.fe as fe,
        (select sh.consignee from shipment_detail sh where sh.shipment_id = s.id fetch next 1 rows only) as consignee,
        (select count(sh.id) from shipment_detail sh where sh.shipment_id = s.id) as contAmount
        from shipment s
        left join shipment_detail sh on s.id = sh.shipment_id 
        left join pickup_assign p on s.id = p.shipment_id
        <where>
            and sh.payment_status = 'Y'
            and p.shipment_id is not null
            and p.driver_id = #{driverId}
            <if test="serviceType != null"> and s.service_type = #{serviceType}</if>
        </where>
        group by s.id, s.bl_no, s.booking_no, sh.fe, s.create_time
        order by s.create_time desc
    </select>
    <select id="selectShipmentListForRegister" parameterType="Shipment" resultType="Shipment">
        select id,
			logistic_account_id as logisticAccountId,
			logistic_group_id as logisticGroupId,
			service_type as serviceType,
			bl_no as blNo,
			booking_no as bookingNo,
			ope_code as opeCode,
			container_amount as containerAmount, 
			edo_flg as edoFlg, 
			specific_cont_flg as specificContFlg, 
			cont_supply_status as contSupplyStatus, 
			status, 
			remark, 
			order_number as orderNumber, 
			house_bill as houseBill, 
			create_by as createBy, 
			create_time as createTime, 
			update_by as updateBy, 
			update_time as updateTime,
            send_cont_empty_type as sendContEmptyType,
			consignee as consignee
        from (select
			s.id,
			s.logistic_account_id,
			s.logistic_group_id,
			s.service_type,
			s.bl_no,
			s.booking_no,
			s.ope_code,
			s.container_amount, 
			s.edo_flg, 
			s.specific_cont_flg, 
			s.cont_supply_status , 
			s.status, 
			s.remark, 
			s.order_number, 
			s.house_bill, 
			s.create_by, 
			s.create_time, 
			s.update_by, 
			s.update_time,
            s.send_cont_empty_type ,
			(select sh.consignee from shipment_detail sh where sh.shipment_id = s.id FETCH NEXT 1 ROWS ONLY) as consignee
            from shipment s left join shipment_detail sh on s.id = sh.shipment_id
            <where>  
                <if test="id != null "> and s.id = #{id}</if>
                <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
                <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
                <if test="serviceType != null "> and s.service_type = #{serviceType}</if>
                <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
                <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
                <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
                <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
                <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
                <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
                <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
                <if test="status != null  and status != '' and status != 4"> and s.status != 4</if>
                <if test="status != null  and status != '' and status == 4"> and s.status = #{status}</if>
                <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
                <if test="params.containerNo != null  and params.containerNo != ''"> and upper(sh.container_no) like concat(concat('%', #{params.containerNo}), '%')</if>
                <if test="params.consignee != null  and params.consignee != ''"> and upper(sh.consignee) like concat(concat('%', #{params.consignee}), '%')</if>
                <if test="params.fromDate != null and params.fromDate != ''">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
                <if test="params.toDate != null and params.toDate != ''">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            </where>
            group by s.id,
                s.logistic_account_id,
                s.logistic_group_id,
                s.service_type,
                s.bl_no,
                s.booking_no,
                s.ope_code,
                s.container_amount, 
                s.edo_flg, 
                s.specific_cont_flg, 
                s.cont_supply_status, 
                s.status, 
                s.remark, 
                s.order_number, 
                s.house_bill, 
                s.create_by, 
                s.create_time, 
                s.update_by, 
                s.update_time,
                s.send_cont_empty_type)
        order by create_time desc
    </select>

    <select id="getShipmentListForContSupply" parameterType="Shipment" resultMap="ShipmentResult">
        select id,
			logistic_account_id,
			logistic_group_id,
			service_type,
			bl_no,
			booking_no,
			ope_code,
			container_amount, 
			edo_flg, 
			specific_cont_flg, 
			cont_supply_status, 
			status, 
			remark, 
			order_number, 
			house_bill, 
			create_by, 
			create_time, 
			update_by, 
			update_time,
            send_cont_empty_type,
			logistic_name
        from (select
			s.id,
			s.logistic_account_id,
			s.logistic_group_id,
			s.service_type,
			s.bl_no,
			s.booking_no,
			s.ope_code,
			s.container_amount, 
			s.edo_flg, 
			s.specific_cont_flg, 
			s.cont_supply_status , 
			s.status, 
			s.remark, 
			s.order_number, 
			s.house_bill, 
			s.create_by, 
			s.create_time, 
			s.update_by, 
			s.update_time,
            s.send_cont_empty_type ,
			(select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as logistic_name
            from shipment s left join shipment_detail sh on s.id = sh.shipment_id
            <where>  
                s.id is not null
                and sh.cont_supply_status != 'N'
                <if test="id != null "> and s.id = #{id}</if>
                <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
                <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
                <if test="serviceType != null "> and s.service_type = #{serviceType}</if>
                <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
                <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
                <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
                <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
                <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
                <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
                <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
                <if test="status != null  and status != ''"> and s.status = #{status}</if>
                <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
                <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
                <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
                <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
                <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
                <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
                <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
                <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
                <if test="params.blOrBooking != null and params.blOrBooking != ''">
                    and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
                </if>
                <if test="params.sztp != null and params.sztp != ''"> and sztp like concat(concat('%', #{params.sztp}), '%')</if>
            </where>
            group by s.id,
                s.logistic_account_id,
                s.logistic_group_id,
                s.service_type,
                s.bl_no,
                s.booking_no,
                s.ope_code,
                s.container_amount, 
                s.edo_flg, 
                s.specific_cont_flg, 
                s.cont_supply_status, 
                s.status, 
                s.remark, 
                s.order_number, 
                s.house_bill, 
                s.create_by, 
                s.create_time, 
                s.update_by, 
                s.update_time,
                s.send_cont_empty_type)
        order by update_time desc
    </select>
     
     <select id="selectShipmentListByWithShipmentDetailDangerous" parameterType="Shipment" resultMap="ShipmentResult">
        select sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code, 
        s.container_amount,s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.order_number, 
        s.house_bill, s.create_by, s.create_time, s.update_by, s.update_time,sh.sztp,
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as "logistic_name"

        from shipment s left join shipment_detail sh on s.id = sh.shipment_id

        <where>  
            s.id is not null  and sh.dangerous is not null
            <if test="id != null "> and s.id = #{id}</if>
            
            <if test="sztp != null and sztp != ''"> and sztp like concat(concat('%', #{sztp}), '%')</if>
            
            <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
             
            <if test="params.serviceType != null and params.serviceType != ''">and s.service_type = #{params.serviceType}</if>
            
            <if test="params.statusCont != null and params.statusCont != ''">and sh.dangerous = #{params.statusCont}</if>
            
            <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and s.status = #{status}</if>
            <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
            <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
            <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
            <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
            <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
            <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
            <if test="params.serviceArray != null">
                and s.service_type in
                <foreach item="service" collection="params.serviceArray" open="(" separator="," close=")">
                    #{service}
                </foreach>
            </if>
            <if test="params.blOrBooking != null and params.blOrBooking != ''">
                and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
            </if>
        </where>

        group by sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, 
        s.ope_code, s.container_amount, s.edo_flg, s.specific_cont_flg, 
        s.cont_supply_status, s.status, s.remark, s.order_number, s.house_bill, s.create_by, 
        s.create_time, s.update_by, s.update_time,sh.sztp

        order by create_time desc
    </select>
    
    
    
    
    
     <select id="selectShipmentListByWithShipmentOverSize" parameterType="Shipment" resultMap="ShipmentResult">
        select sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code, 
        s.container_amount,s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.order_number, 
        s.house_bill, s.create_by, s.create_time, s.update_by, s.update_time,sh.sztp,
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as "logistic_name"

        from shipment s left join shipment_detail sh on s.id = sh.shipment_id

        <where>  
            s.id is not null and  s.service_type = '1' and
            (sh.OVERSIZE_TOP is not  null OR   sh.OVERSIZE_RIGHT is not null OR sh.OVERSIZE_LEFT is not null
            OR sh.OVERSIZE_FRONT is not null  OR sh.OVERSIZE_BACK is not null)
            <if test="id != null "> and s.id = #{id}</if>
            
            <if test="sztp != null and sztp != ''"> and sztp like concat(concat('%', #{sztp}), '%')</if>
            
            <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
             
            <if test="params.serviceType != null and params.serviceType != ''">and s.service_type = #{params.serviceType}</if>
            
             <if test="params.statusCont != null and params.statusCont != ''">and sh.oversize = #{params.statusCont}</if>
            
            <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and s.status = #{status}</if>
            <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
            <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
            <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
            <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
            <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
            <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
            <if test="params.serviceArray != null">
                and s.service_type in
                <foreach item="service" collection="params.serviceArray" open="(" separator="," close=")">
                    #{service}
                </foreach>
            </if>
            <if test="params.blOrBooking != null and params.blOrBooking != ''">
                and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
            </if>
        </where>

        group by sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, 
        s.ope_code, s.container_amount, s.edo_flg, s.specific_cont_flg, 
        s.cont_supply_status, s.status, s.remark, s.order_number, s.house_bill, s.create_by, 
        s.create_time, s.update_by, s.update_time,sh.sztp

        order by create_time desc
    </select>
    
    
    
    <select id="selectShipmentListByWithShipmentContR" parameterType="Shipment" resultMap="ShipmentResult">
        select sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code, 
        s.container_amount,s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.order_number, 
        s.house_bill, s.create_by, s.create_time, s.update_by, s.update_time,sh.sztp,
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as "logistic_name"

        from shipment s left join shipment_detail sh on s.id = sh.shipment_id

        <where>  
            s.id is not null  and  sh.sztp like concat(concat('%', 'R'), '%') 
            and  s.service_type = '1'
            <if test="id != null "> and s.id = #{id}</if>
            
            <if test="sztp != null and sztp != ''"> and sztp like concat(concat('%', #{sztp}), '%')</if>
            
            <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
             
            <if test="params.serviceType != null and params.serviceType != ''">and s.service_type = #{params.serviceType}</if>
            
            <if test="params.statusCont != null and params.statusCont != ''">and sh.frozen_status = #{params.statusCont}</if>
            
            <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and s.status = #{status}</if>
            <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
            <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
            <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
            <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
            <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
            <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
            <if test="params.serviceArray != null">
                and s.service_type in
                <foreach item="service" collection="params.serviceArray" open="(" separator="," close=")">
                    #{service}
                </foreach>
            </if>
            <if test="params.blOrBooking != null and params.blOrBooking != ''">
                and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
            </if>
        </where>

        group by sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, 
        s.ope_code, s.container_amount, s.edo_flg, s.specific_cont_flg, 
        s.cont_supply_status, s.status, s.remark, s.order_number, s.house_bill, s.create_by, 
        s.create_time, s.update_by, s.update_time,sh.sztp

        order by create_time desc
    </select>
     
     
     <select id="selectShipmentListByWithShipmentDetailFilterApply" parameterType="Shipment" resultMap="ShipmentResult">
        select sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code, 
        s.container_amount,s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.order_number, 
        s.house_bill, s.create_by, s.create_time, s.update_by, s.update_time,sh.sztp,
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as "logistic_name"

        from shipment s left join shipment_detail sh on s.id = sh.shipment_id

        <where>  
            s.id is not null and sh.cont_special_status is not null
            <if test="id != null "> and s.id = #{id}</if>
            
            <if test="sztp != null and sztp != ''"> and sztp like concat(concat('%', #{sztp}), '%')</if>
            
            <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
             
            <if test="params.serviceType != null and params.serviceType != ''">and s.service_type = #{params.serviceType}</if>
            
            <if test="params.statusCont != null and params.statusCont != ''">and sh.cont_special_status = #{params.statusCont}</if>
            
            <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and s.status = #{status}</if>
            <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
            <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
            <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
            <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
            <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
            <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
            <if test="params.paymentStatus != null and params.paymentStatus != ''">and sh.payment_status = #{params.paymentStatus}</if>
            <if test="params.specialService != null">and sh.special_service = #{params.specialService}</if>
            <if test="params.serviceArray != null">
                and s.service_type in
                <foreach item="service" collection="params.serviceArray" open="(" separator="," close=")">
                    #{service}
                </foreach>
            </if>
            <if test="params.blOrBooking != null and params.blOrBooking != ''">
                and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
            </if>
        </where>

        group by sh.cont_special_status,s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, 
        s.ope_code, s.container_amount, s.edo_flg, s.specific_cont_flg, 
        s.cont_supply_status, s.status, s.remark, s.order_number, s.house_bill, s.create_by, 
        s.create_time, s.update_by, s.update_time,sh.sztp

        order by create_time desc
    </select>
    

    <select id="selectShipmentListByWithShipmentDetailFilter" parameterType="Shipment" resultMap="ShipmentResult">
        select s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code, 
        s.container_amount,s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.order_number, 
        s.house_bill, s.create_by, s.create_time, s.update_by, s.update_time,
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as "logistic_name"

        from shipment s full outer join shipment_detail sh on s.id = sh.shipment_id

        <where>  
            s.id is not null
            <if test="id != null "> and s.id = #{id}</if>
            <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
            <if test="serviceType != null "> and s.service_type = #{serviceType}</if>
            <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and s.edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and s.status = #{status}</if>
            <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
            <if test="params.fromDate != null">and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null">and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
            <if test="params.sztp != null and params.sztp != ''">and sh.sztp like concat(concat('%', #{params.sztp}), '%')</if>
            <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
            <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
            <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
           
            <if test="params.dangerous != null and params.dangerous != ''">and sh.dangerous = #{params.dangerous}</if>
			<if test="params.frozenStatus != null and params.frozenStatus != ''">and sh.frozen_status = #{params.frozenStatus}</if>
 			<if test="params.finishStatus != null and params.finishStatus != ''">and sh.finish_status = #{params.finishStatus}</if>
            <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
            <if test="params.paymentStatus != null and params.paymentStatus != ''">and sh.payment_status = #{params.paymentStatus}</if>
            <if test="params.userVerifyStatus != null and params.userVerifyStatus != ''">and sh.user_verify_status = #{params.userVerifyStatus}</if>
            <if test="params.specialService != null">and sh.special_service = #{params.specialService}</if>
            <if test="params.oversize != null and params.oversize != ''">and sh.oversize = #{params.oversize}</if>
            <if test="params.serviceArray != null">
                and s.service_type in
                <foreach item="service" collection="params.serviceArray" open="(" separator="," close=")">
                    #{service}
                </foreach>
            </if>
            <if test="params.blOrBooking != null and params.blOrBooking != ''">
                and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
            </if>
            <if test="params.fromDateSetupTemperature != null">and sh.day_setup_temperature &gt;= to_date(#{params.fromDateSetupTemperature },'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDateSetupTemperature != null">and sh.day_setup_temperature &lt;= to_date(#{params.toDateSetupTemperature },'dd/MM/yyyy HH24:mi:ss')</if>
 			<if test="params.powerDrawDateStatus != null and params.powerDrawDateStatus != ''">and sh.power_draw_date_status = #{params.powerDrawDateStatus}</if>
        </where>

        group by s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, 
        s.ope_code, s.container_amount, s.edo_flg, s.specific_cont_flg, 
        s.cont_supply_status, s.status, s.remark, s.order_number, s.house_bill, s.create_by, 
        s.create_time, s.update_by, s.update_time

        order by create_time desc
    </select>
    <select id="getShipmentsForSupportCustom" parameterType="Shipment" resultMap="ShipmentResult">
        select s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, s.ope_code, 
        s.container_amount,s.edo_flg, s.specific_cont_flg, s.cont_supply_status, s.status, s.remark, s.order_number, 
        s.house_bill, s.create_by, s.create_time, s.update_by, s.update_time,
        (SELECT MIN(CUSTOM_SCAN_TIME) FROM SHIPMENT_DETAIL SH WHERE SH.SHIPMENT_ID = S.ID AND CUSTOM_STATUS = 'Y' AND SH.CUSTOM_SCAN_TIME IS NOT NULL) as customScanTime,
        (select l.group_name from logistic_group l where l.id = s.logistic_group_id FETCH NEXT 1 ROWS ONLY) as "logistic_name"
        from shipment S right join shipment_detail sh on s.id = sh.shipment_id
        <where>  
            s.ID IN (SELECT SHIPMENT_ID FROM SHIPMENT_DETAIL WHERE CUSTOM_STATUS = 'Y' GROUP BY SHIPMENT_ID)
            <if test="logisticAccountId != null "> and s.logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
            <if test="serviceType != null "> and s.service_type = #{serviceType}</if>
            <if test="blNo != null and blNo != ''"> and upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and s.ope_code = #{opeCode}</if>
            <if test="containerAmount != null "> and s.container_amount = #{containerAmount}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and S.edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and s.specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and s.cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and s.status = #{status}</if>
            <if test="remark != null  and remark != ''"> and s.remark = #{remark}</if>
            <if test="params.containerNo != null and params.containerNo != ''">and sh.container_no like concat(concat('%', #{params.containerNo}), '%')</if>
            <if test="params.consignee != null and params.consignee != ''">and sh.consignee like concat(concat('%', #{params.consignee}), '%')</if>
            <if test="params.vslNm != null and params.vslNm != ''">and sh.vsl_nm = #{params.vslNm}</if>
            <if test="params.voyNo != null and params.voyNo != ''">and sh.voy_no = #{params.voyNo}</if>
            <if test="params.doStatus != null and params.doStatus != ''">and sh.do_status = #{params.doStatus}</if>
            <if test="params.processStatus != null and params.processStatus != ''">and sh.process_status = #{params.processStatus}</if>
            <if test="params.blOrBooking != null and params.blOrBooking != ''">
                and ((upper(s.booking_no) like concat(concat('%', #{params.blOrBooking}), '%')) or (upper(s.bl_no) like concat(concat('%', #{params.blOrBooking}), '%')))
            </if>
        </where>
        group by s.id, s.logistic_account_id, s.logistic_group_id, s.service_type, s.bl_no, s.booking_no, 
        s.ope_code, s.container_amount, s.edo_flg, s.specific_cont_flg, 
        s.cont_supply_status, s.status, s.remark, s.order_number, s.house_bill, s.create_by, 
        s.create_time, s.update_by, s.update_time

        ORDER BY customScanTime ASC
    </select>

    <select id="selectShipmentListForExtensionDate" parameterType="Shipment" resultMap="ShipmentResult">
        select * from
        (select id, logistic_account_id, logistic_group_id, service_type, bl_no, booking_no, ope_code, 
        edo_flg, specific_cont_flg, cont_supply_status, status, remark, order_number, 
        house_bill, create_by, create_time, update_by, update_time, 
        (select count(*) from shipment_detail sh where sh.shipment_id = s.id and sh.process_status = 'Y' and sh.finish_status = 'N') as container_amount 
        from shipment s
        <where>  
            <if test="id != null "> and id = #{id}</if>
            <if test="logisticAccountId != null "> and logistic_account_id = #{logisticAccountId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="serviceType != null "> and service_type = #{serviceType}</if>
            <if test="blNo != null and blNo != ''"> and upper(bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="bookingNo != null and bookingNo != ''"> and upper(booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="edoFlg != null  and edoFlg != ''"> and edo_flg = #{edoFlg}</if>
            <if test="specificContFlg != null"> and specific_cont_flg = #{specificContFlg}</if>
            <if test="contSupplyStatus != null"> and cont_supply_status = #{contSupplyStatus}</if>
            <if test="status != null  and status != ''"> and status = #{status}</if>
            <if test="remark != null  and remark != ''"> and remark = #{remark}</if>
            <if test="fromDate != null">and create_time &gt;= #{fromDate}</if>
            <if test="toDate != null">and create_time &lt;= #{toDate}</if>
        </where>)
        where container_amount > 0
        order by create_time desc
    </select>
</mapper>