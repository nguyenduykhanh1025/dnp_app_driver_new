<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="vn.com.irtech.eport.logistic.mapper.ShipmentDetailMapper">
    
    <resultMap type="ShipmentDetail" id="ShipmentDetailResult">
        <result property="id"    column="id"    />
        <result property="shipmentId"    column="shipment_id"    />
        <result property="logisticGroupId"    column="logistic_group_id"    />
        <result property="processOrderId"    column="process_order_id"    />
        <result property="registerNo"    column="register_no"    />
        <result property="containerNo"    column="container_no"    />
        <result property="containerStatus"    column="container_status"    />
        <result property="sztp"    column="sztp"    />
        <result property="sztpDefine"    column="sztp_define"    />
        <result property="temperature"    column="temperature"    />
        <result property="fe"    column="fe"    />
        <result property="bookingNo"    column="booking_no"    />
        <result property="blNo"    column="bl_no"    />
        <result property="sealNo"    column="seal_no"    />
        <result property="consignee"    column="consignee"    />
        <result property="expiredDem"    column="expired_dem"    />
        <result property="detFreeTime"    column="det_free_time"    />
        <result property="emptyExpiredDem"    column="empty_expired_dem"    />
        <result property="wgt"    column="wgt"    />
        <result property="vslName"    column="vsl_name"    />
        <result property="vslNm"    column="vsl_nm"    />
        <result property="voyNo"    column="voy_no"    />
        <result property="voyCarrier"    column="voy_carrier"    />
        <result property="opeCode"    column="ope_code"    />
        <result property="carrierName"    column="carrier_name"    />
        <result property="loadingPort"    column="loading_port"    />
        <result property="dischargePort"    column="discharge_port"    />
        <result property="transportType"    column="transport_type"    />
        <result property="emptyDepot"    column="empty_depot"    />
        <result property="emptyDepotLocation"    column="empty_depot_location"    />
        <result property="cargoType"    column="cargo_type"    />
        <result property="commodity"    column="commodity"    />
        <result property="vgmChk"    column="vgm_chk"    />
        <result property="vgm"    column="vgm"    />
        <result property="vgmPersonInfo"    column="vgm_person_info"    />
        <result property="preorderPickup"    column="preorder_pickup"    />
        <result property="prePickupPaymentStatus"    column="pre_pickup_payment_status"    />
        <result property="customStatus"    column="custom_status"    />
        <result property="paymentStatus"    column="payment_status"    />
        <result property="processStatus"    column="process_status"    />
        <result property="doStatus"    column="do_status"    />
        <result property="doReceivedTime"    column="do_received_time"    />
        <result property="userVerifyStatus"    column="user_verify_status"    />
        <result property="finishStatus"    column="finish_status"    />
        <result property="status"    column="status"    />
        <result property="orderNo"    column="order_no"    />
        <result property="taxCode"    column="tax_code"    />
        <result property="consigneeByTaxCode"    column="consignee_by_tax_code"    />
        <result property="customsNo"    column="customs_no"    />
        <result property="contSupplyStatus"    column="cont_supply_status"    />
        <result property="planningDate"    column="planning_date"    />
        <result property="qualityRequirement"    column="quality_requirement"    />
        <result property="contSupplyRemark"    column="cont_supply_remark"    />
        <result property="contSupplierName"    column="cont_supplier_name"    />
        <result property="remark"    column="remark"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
        <result property="payType"    column="pay_type"   />
        <result property="payer"    column="payer"   />
        <result property="payerName"    column="payer_name"   />
        <result property="assignNumber"    column="assign_number"   />
        <result property="serviceType"    column="service_type"   />
        <result property="customScanTime"    column="custom_scan_time"   />
        <result property="deliveryAddress"    column="delivery_address"   />
        <result property="deliveryMobile"    column="delivery_mobile"   />
        <result property="deliveryRemark"    column="delivery_remark"   />
        <result property="eta"    column="eta"   />
        <result property="etd"    column="etd"   />
        <result property="location"    column="location"   />
    </resultMap>

    <sql id="selectShipmentDetailVo">
        select id, shipment_id, logistic_group_id, process_order_id, register_no, container_no, container_status, sztp, 
        sztp_define, temperature, fe, booking_no, bl_no, seal_no, consignee, expired_dem, empty_expired_dem, wgt, 
        vsl_name, vsl_nm, voy_no, voy_carrier, ope_code, carrier_name, loading_port, discharge_port, transport_type, 
        empty_depot, empty_depot_location, cargo_type, vgm_chk, vgm, vgm_person_info, preorder_pickup, 
        pre_pickup_payment_status, custom_status, payment_status, process_status, do_status, do_received_time, 
        user_verify_status, finish_status, status, order_no, tax_code, consignee_by_tax_code, cont_supply_status, 
        planning_date, quality_requirement, cont_supply_remark, cont_supplier_name, remark, pay_type, payer, payer_name, customs_no, 
        custom_scan_time, delivery_address, delivery_mobile, delivery_remark, eta, etd, create_by, create_time, update_by, update_time from shipment_detail
    </sql>
     <select id="countShipmentDetailList" parameterType="ShipmentDetail" resultType="Long">
        select count(*) from shipment_detail
         <where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerNo != null  and containerNo != ''"> and container_no = #{containerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp = #{sztp}</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="bookingNo != null  and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="blNo != null  and blNo != ''"> and bl_no = #{blNo}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="finishStatus != null  and finishStatus != ''"> and finish_status = #{finishStatus}</if>
            <if test="status != null "> and status = #{status}</if>
            <if test="orderNo != null and orderNo != ''"> and order_no = #{orderNo}</if>
        </where>
    </select>
    <select id="selectShipmentDetailList" parameterType="ShipmentDetail" resultMap="ShipmentDetailResult">
        <include refid="selectShipmentDetailVo"/>
        <where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerNo != null  and containerNo != ''"> and container_no = #{containerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp like concat(#{sztp}, '%')</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="bookingNo != null  and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="blNo != null  and blNo != ''"> and bl_no = #{blNo}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null  and doReceivedTime != ''"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="finishStatus != null  and finishStatus != ''"> and finish_status = #{finishStatus}</if>
            <if test="status != null "> and status = #{status}</if>
            <if test="contSupplyStatus != null and contSupplyStatus != 'contSupplyStatus'"> and cont_supply_status = #{contSupplyStatus}</if>
            <if test="planningDate != null"> and planning_date = #{planningDate}</if>
            <if test="qualityRequirement != null and qualityRequirement != 'qualityRequirement'"> and quality_requirement = #{qualityRequirement}</if>
            <if test="contSupplyRemark != null and contSupplyRemark != 'contSupplyRemark'"> and cont_supply_remark = #{contSupplyRemark}</if>
            <if test="contSupplierName != null and contSupplierName != 'contSupplierName'"> and cont_supplier_name = #{contSupplierName}</if>
        </where>
       
    </select>

    <select id="selectShipmentDetailListReport" parameterType="ShipmentDetail" resultMap="ShipmentDetailResult">
        <include refid="selectShipmentDetailVo"/>
        <where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp = #{sztp}</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null  and doReceivedTime != ''"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="finishStatus != null  and finishStatus != ''"> and finish_status = #{finishStatus}</if>
            <if test="status != null "> and status = #{status}</if>
            <if test="params.fromDate != null"> and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null"> and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="bookingNo != null  and bookingNo != ''">and (upper(booking_no) like concat(concat('%', #{bookingNo}),
                '%')
            </if>
            <if test="blNo != null  and blNo != ''">or upper(bl_no) like concat(concat('%', #{blNo}), '%'))</if>
            <if test="containerNo != null  and containerNo != ''">or upper(container_no) like concat(concat('%',
                #{containerNo}), '%')
            </if>
        </where>
       
    </select>

    <select id="getShipmentDetailList" parameterType="ShipmentDetail" resultMap="ShipmentDetailResult">
        select id, shipment_id, logistic_group_id, process_order_id, register_no, container_no, empty_expired_dem, empty_depot_location,
        	container_status, sztp, sztp_define, temperature, fe, booking_no, bl_no, seal_no, consignee, expired_dem, det_free_time, wgt, vsl_name,
        	vsl_nm || ': '|| vsl_name as vsl_nm,
        	voy_no, voy_carrier,
        	ope_code || ': ' || carrier_name as ope_code,
        	carrier_name, loading_port, discharge_port, transport_type,
        	empty_depot, cargo_type, vgm_chk, vgm, vgm_person_info, preorder_pickup, pre_pickup_payment_status,
        	custom_status, customs_no, custom_scan_time, payment_status, process_status, do_status, do_received_time, user_verify_status, finish_status,
        	pay_type, payer, payer_name, delivery_address, delivery_mobile, delivery_remark, cont_supplier_name, eta, etd, status, remark, create_by, create_time, update_by, update_time
        from shipment_detail
        <where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerNo != null  and containerNo != ''"> and container_no = #{containerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp = #{sztp}</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="bookingNo != null  and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="blNo != null  and blNo != ''"> and bl_no = #{blNo}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null  and doReceivedTime != ''"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="finishStatus != null  and finishStatus != ''"> and finish_status = #{finishStatus}</if>
            <if test="status != null "> and status = #{status}</if>
        </where>
    </select>
    <select id="getShipmentDetailListForSendFReceiveE" parameterType="ShipmentDetail" resultMap="ShipmentDetailResult">
        select id, shipment_id, logistic_group_id, process_order_id, register_no, container_no, empty_expired_dem, empty_depot_location,
        	container_status,
        	sztp || ': ' || sztp_define as sztp,
        	sztp_define, temperature, fe, booking_no, bl_no, seal_no, consignee, expired_dem, det_free_time, wgt, vsl_name, voy_no, voy_carrier,
        	vsl_nm || ' - ' || vsl_name|| ' - ' || voy_carrier as vsl_nm,
        	ope_code || ': ' || carrier_name as ope_code,
        	carrier_name, loading_port, discharge_port, transport_type,
        	empty_depot, cargo_type, commodity, vgm_chk, vgm, vgm_person_info, preorder_pickup, pre_pickup_payment_status,
        	custom_status, payment_status, process_status, do_status, do_received_time, user_verify_status, finish_status,
            cont_supply_status, planning_date, quality_requirement, cont_supply_remark, cont_supplier_name, pay_type, payer, payer_name, customs_no, custom_scan_time, 
        	delivery_address, delivery_mobile, delivery_remark, eta, etd, status, remark, create_by, create_time, update_by, update_time 
        from shipment_detail
        <where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerNo != null  and containerNo != ''"> and container_no = #{containerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp = #{sztp}</if>
            <if test="sztpDefine != null  and sztpDefine != ''"> and sztp_define = #{sztpDefine}</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="bookingNo != null  and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="blNo != null  and blNo != ''"> and bl_no = #{blNo}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null  and doReceivedTime != ''"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="finishStatus != null  and finishStatus != ''"> and finish_status = #{finishStatus}</if>
            <if test="status != null "> and status = #{status}</if>
            <if test="contSupplyStatus != null and contSupplyStatus != 'contSupplyStatus'"> and cont_supply_status = #{contSupplyStatus}</if>
            <if test="planningDate != null"> and planning_date = #{planningDate}</if>
            <if test="qualityRequirement != null and qualityRequirement != 'qualityRequirement'"> and quality_requirement = #{qualityRequirement}</if>
            <if test="contSupplyRemark != null and contSupplyRemark != 'contSupplyRemark'"> and cont_supply_remark = #{contSupplyRemark}</if>
            <if test="contSupplierName != null and contSupplierName != 'contSupplierName'"> and cont_supplier_name = #{contSupplierName}</if>
        </where>
    </select>

    <select id="selectShipmentDetailById" parameterType="Long" resultMap="ShipmentDetailResult">
        <include refid="selectShipmentDetailVo"/>
        where id = #{id}
    </select>
        
    <insert id="insertShipmentDetail" parameterType="ShipmentDetail" useGeneratedKeys="true" keyProperty="id">
        <selectKey keyProperty="id" order="BEFORE" resultType="Long">
			select seq_shipment_detail.nextval as id from DUAL
		</selectKey>
        insert into shipment_detail
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null and id != 0">id,</if>
            <if test="shipmentId != null ">shipment_id,</if>
            <if test="logisticGroupId != null ">logistic_group_id,</if>
            <if test="processOrderId != null">process_order_id,</if>
            <if test="registerNo != null  and registerNo != ''">register_no,</if>
            <if test="containerNo != null  and containerNo != ''">container_no,</if>
            <if test="containerStatus != null  and containerStatus != ''">container_status,</if>
            <if test="sztp != null  and sztp != ''">sztp,</if>
            <if test="sztpDefine != null  and sztpDefine != ''">sztp_define,</if>
            <if test="temperature != null ">temperature,</if>
            <if test="fe != null  and fe != ''">fe,</if>
            <if test="bookingNo != null  and bookingNo != ''">booking_no,</if>
            <if test="blNo != null  and blNo != ''">bl_no,</if>
            <if test="sealNo != null  and sealNo != ''">seal_no,</if>
            <if test="consignee != null  and consignee != ''">consignee,</if>
            <if test="expiredDem != null ">expired_dem,</if>
            <if test="detFreeTime != null ">det_free_time,</if>
            <if test="emptyExpiredDem != null ">empty_expired_dem,</if>
            <if test="wgt != null ">wgt,</if>
            <if test="vslName != null  and vslName != ''">vsl_name,</if>
            <if test="vslNm != null  and vslNm != ''">vsl_nm,</if>
            <if test="voyNo != null  and voyNo != ''">voy_no,</if>
            <if test="voyCarrier != null  and voyCarrier != ''">voy_carrier,</if>
            <if test="opeCode != null  and opeCode != ''">ope_code,</if>
            <if test="carrierName != null  and carrierName != ''">carrier_name,</if>
            <if test="loadingPort != null  and loadingPort != ''">loading_port,</if>
            <if test="dischargePort != null  and dischargePort != ''">discharge_port,</if>
            <if test="transportType != null  and transportType != ''">transport_type,</if>
            <if test="emptyDepot != null  and emptyDepot != ''">empty_depot,</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''">empty_depot_location,</if>
            <if test="cargoType != null  and cargoType != ''">cargo_type,</if>
            <if test="commodity != null  and commodity != ''">commodity,</if>
            <if test="vgmChk != null ">vgm_chk,</if>
            <if test="vgm != null  and vgm != ''">vgm,</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''">vgm_person_info,</if>
            <if test="preorderPickup != null  and preorderPickup != ''">preorder_pickup,</if>
            <if test="prePickupPaymentStatus != null">pre_pickup_payment_status,</if>
            <if test="customStatus != null  and customStatus != ''">custom_status,</if>
            <if test="paymentStatus != null  and paymentStatus != ''">payment_status,</if>
            <if test="processStatus != null  and processStatus != ''">process_status,</if>
            <if test="doStatus != null  and doStatus != ''">do_status,</if>
            <if test="doReceivedTime != null">do_received_time,</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''">user_verify_status,</if>
            <if test="finishStatus != null  and finishStatus != ''">finish_status,</if>
            <if test="status != null ">status,</if>
            <if test="orderNo != null and orderNo != ''">order_no,</if>
            <if test="taxCode != null and taxCode != ''">tax_code,</if>
            <if test="consigneeByTaxCode != null and consigneeByTaxCode != ''">consignee_by_tax_code,</if>
            <if test="customsNo != null and customsNo != ''">customs_no,</if>
            <if test="customScanTime != null">custom_scan_time,</if>
            <if test="contSupplyStatus != null and contSupplyStatus != 'contSupplyStatus'">cont_supply_status,</if>
            <if test="planningDate != null">planning_date,</if>
            <if test="qualityRequirement != null and qualityRequirement != 'qualityRequirement'">quality_requirement,</if>
            <if test="contSupplyRemark != null and contSupplyRemark != 'contSupplyRemark'">cont_supply_remark,</if>
            <if test="contSupplierName != null and contSupplierName != 'contSupplierName'">cont_supplier_name,</if>
            <if test="payType != null  and payType != ''">pay_type,</if>
            <if test="payer != null  and payer != ''">payer,</if>
            <if test="payerName != null  and payerName != ''">payer_name,</if>
            <if test="deliveryAddress != null  and deliveryAddress != ''">delivery_address,</if>
            <if test="deliveryMobile != null  and deliveryMobile != ''">delivery_mobile,</if>
            <if test="deliveryRemark != null  and deliveryRemark != ''">delivery_remark,</if>
            <if test="eta != null">eta,</if>
            <if test="etd != null">etd,</if>
            <if test="location != null">location,</if>
            <if test="remark != null  and remark != ''">remark,</if>
            <if test="createBy != null  and createBy != ''">create_by,</if>
            create_time
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
 			<if test="id != null">#{id},</if>
            <if test="shipmentId != null ">#{shipmentId},</if>
            <if test="logisticGroupId != null ">#{logisticGroupId},</if>
            <if test="processOrderId != null">#{processOrderId},</if>
            <if test="registerNo != null  and registerNo != ''">#{registerNo},</if>
            <if test="containerNo != null  and containerNo != ''">#{containerNo},</if>
            <if test="containerStatus != null  and containerStatus != ''">#{containerStatus},</if>
            <if test="sztp != null  and sztp != ''">#{sztp},</if>
            <if test="sztpDefine != null  and sztpDefine != ''">#{sztpDefine},</if>
            <if test="temperature != null ">#{temperature},</if>
            <if test="fe != null  and fe != ''">#{fe},</if>
            <if test="bookingNo != null  and bookingNo != ''">#{bookingNo},</if>
            <if test="blNo != null  and blNo != ''">#{blNo},</if>
            <if test="sealNo != null  and sealNo != ''">#{sealNo},</if>
            <if test="consignee != null  and consignee != ''">#{consignee},</if>
            <if test="expiredDem != null ">#{expiredDem},</if>
            <if test="detFreeTime != null ">#{detFreeTime},</if>
            <if test="emptyExpiredDem != null ">#{emptyExpiredDem},</if>
            <if test="wgt != null ">#{wgt},</if>
            <if test="vslName != null  and vslName != ''">#{vslName},</if>
            <if test="vslNm != null  and vslNm != ''">#{vslNm},</if>
            <if test="voyNo != null  and voyNo != ''">#{voyNo},</if>
            <if test="voyCarrier != null  and voyCarrier != ''">#{voyCarrier},</if>
            <if test="opeCode != null  and opeCode != ''">#{opeCode},</if>
            <if test="carrierName != null  and carrierName != ''">#{carrierName},</if>
            <if test="loadingPort != null  and loadingPort != ''">#{loadingPort},</if>
            <if test="dischargePort != null  and dischargePort != ''">#{dischargePort},</if>
            <if test="transportType != null  and transportType != ''">#{transportType},</if>
            <if test="emptyDepot != null  and emptyDepot != ''">#{emptyDepot},</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''">#{emptyDepotLocation},</if>
            <if test="cargoType != null  and cargoType != ''">#{cargoType},</if>
            <if test="commodity != null  and commodity != ''">#{commodity},</if>
            <if test="vgmChk != null ">#{vgmChk},</if>
            <if test="vgm != null  and vgm != ''">#{vgm},</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''">#{vgmPersonInfo},</if>
            <if test="preorderPickup != null  and preorderPickup != ''">#{preorderPickup},</if>
            <if test="prePickupPaymentStatus != null">#{prePickupPaymentStatus},</if>
            <if test="customStatus != null  and customStatus != ''">#{customStatus},</if>
            <if test="paymentStatus != null  and paymentStatus != ''">#{paymentStatus},</if>
            <if test="processStatus != null  and processStatus != ''">#{processStatus},</if>
            <if test="doStatus != null  and doStatus != ''">#{doStatus},</if>
            <if test="doReceivedTime != null">#{doReceivedTime},</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''">#{userVerifyStatus},</if>
            <if test="finishStatus != null  and finishStatus != ''">#{finishStatus},</if>
            <if test="status != null ">#{status},</if>
            <if test="orderNo != null and orderNo != ''">#{orderNo},</if>
            <if test="taxCode != null and taxCode != ''">#{taxCode},</if>
            <if test="consigneeByTaxCode != null and consigneeByTaxCode != ''">#{consigneeByTaxCode},</if>
            <if test="customsNo != null and customsNo != ''">#{customsNo},</if>
            <if test="customScanTime != null">#{customScanTime},</if>
            <if test="contSupplyStatus != null and contSupplyStatus != 'contSupplyStatus'">#{contSupplyStatus},</if>
            <if test="planningDate != null">#{planningDate},</if>
            <if test="qualityRequirement != null and qualityRequirement != 'qualityRequirement'">#{qualityRequirement},</if>
            <if test="contSupplyRemark != null and contSupplyRemark != 'contSupplyRemark'">#{contSupplyRemark},</if>
            <if test="contSupplierName != null and contSupplierName != 'contSupplierName'">#{contSupplierName},</if>
            <if test="payType != null  and payType != ''">#{payType},</if>
            <if test="payer != null  and payer != ''">#{payer},</if>
            <if test="payerName != null  and payerName != ''">#{payerName},</if>
            <if test="deliveryAddress != null and deliveryAddress != ''">#{deliveryAddress},</if>
            <if test="deliveryMobile != null  and deliveryMobile != ''">#{deliveryMobile},</if>
            <if test="deliveryRemark != null  and deliveryRemark != ''">#{deliveryRemark},</if>
            <if test="eta != null">#{eta},</if>
            <if test="etd != null">#{etd},</if>
            <if test="location != null">#{location},</if>
            <if test="remark != null  and remark != ''">#{remark},</if>
            <if test="createBy != null  and createBy != ''">#{createBy},</if>
            sysdate
         </trim>
    </insert>

    <update id="updateShipmentDetail" parameterType="ShipmentDetail">
        update shipment_detail
        <trim prefix="SET" suffixOverrides=",">
            <if test="shipmentId != null ">shipment_id = #{shipmentId},</if>
            <if test="processOrderId != null">process_order_id = #{processOrderId},</if>
            <if test="registerNo != null  and registerNo != ''">register_no = #{registerNo},</if>
            <if test="containerNo != null  and containerNo != ''">container_no = #{containerNo},</if>
            <if test="containerStatus != null  and containerStatus != ''">container_status = #{containerStatus},</if>
            <if test="sztp != null  and sztp != ''">sztp = #{sztp},</if>
            <if test="sztpDefine != null  and sztpDefine != ''">sztp_define = #{sztpDefine},</if>
            <if test="temperature != null ">temperature = #{temperature},</if>
            <if test="fe != null  and fe != ''">fe = #{fe},</if>
            <if test="bookingNo != null  and bookingNo != ''">booking_no = #{bookingNo},</if>
            <if test="blNo != null  and blNo != ''">bl_no = #{blNo},</if>
            <if test="sealNo != null  and sealNo != ''">seal_no = #{sealNo},</if>
            <if test="consignee != null  and consignee != ''">consignee = #{consignee},</if>
            <if test="expiredDem != null ">expired_dem = #{expiredDem},</if>
            <if test="detFreeTime != null ">det_free_time = #{detFreeTime},</if>
            <if test="emptyExpiredDem != null ">empty_expired_dem = #{emptyExpiredDem},</if>
            <if test="wgt != null ">wgt = #{wgt},</if>
            <if test="vslName != null  and vslName != ''">vsl_name = #{vslName},</if>
            <if test="vslNm != null  and vslNm != ''">vsl_nm = #{vslNm},</if>
            <if test="voyNo != null  and voyNo != ''">voy_no = #{voyNo},</if>
            <if test="voyCarrier != null  and voyCarrier != ''">voy_carrier = #{voyCarrier},</if>
            <if test="opeCode != null  and opeCode != ''">ope_code = #{opeCode},</if>
            <if test="carrierName != null  and carrierName != ''">carrier_name = #{carrierName},</if>
            <if test="loadingPort != null  and loadingPort != ''">loading_port = #{loadingPort},</if>
            <if test="dischargePort != null  and dischargePort != ''">discharge_port = #{dischargePort},</if>
            <if test="transportType != null  and transportType != ''">transport_type = #{transportType},</if>
            <if test="emptyDepot != null  and emptyDepot != ''">empty_depot = #{emptyDepot},</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''">empty_depot_location = #{emptyDepotLocation},</if>
            <if test="cargoType != null  and cargoType != ''">cargo_type = #{cargoType},</if>
            <if test="commodity != null  and commodity != ''">commodity = #{commodity},</if>
            <if test="vgmChk != null ">vgm_chk = #{vgmChk},</if>
            <if test="vgm != null  and vgm != ''">vgm = #{vgm},</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''">vgm_person_info = #{vgmPersonInfo},</if>
            <if test="preorderPickup != null  and preorderPickup != ''">preorder_pickup = #{preorderPickup},</if>
            <if test="prePickupPaymentStatus != null">pre_pickup_payment_status = #{prePickupPaymentStatus},</if>
            <if test="customStatus != null  and customStatus != ''">custom_status = #{customStatus},</if>
            <if test="paymentStatus != null  and paymentStatus != ''">payment_status = #{paymentStatus},</if>
            <if test="processStatus != null  and processStatus != ''">process_status = #{processStatus},</if>
            <if test="doStatus != null  and doStatus != ''">do_status = #{doStatus},</if>
            <if test="doReceivedTime != null">do_received_time = #{doReceivedTime},</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''">user_verify_status = #{userVerifyStatus},</if>
            <if test="finishStatus != null  and finishStatus != ''">finish_status = #{finishStatus},</if>
            <if test="status != null ">status = #{status},</if>
            <if test="orderNo != null and orderNo != ''">order_no = #{orderNo},</if>
            <if test="taxCode != null and taxCode != ''">tax_code = #{taxCode},</if>
            <if test="consigneeByTaxCode != null and consigneeByTaxCode != ''">consignee_by_tax_code = #{consigneeByTaxCode},</if>
            <if test="customsNo != null and customsNo != ''">customs_no = #{customsNo},</if>
            <if test="customScanTime != null">custom_scan_time = #{customScanTime},</if>
            <if test="contSupplyStatus != null and contSupplyStatus != 'contSupplyStatus'">cont_supply_status = #{contSupplyStatus},</if>
            <if test="planningDate != null">planning_date = #{planningDate},</if>
            <if test="qualityRequirement != null and qualityRequirement != 'qualityRequirement'">quality_requirement = #{qualityRequirement},</if>
            <if test="contSupplyRemark != null and contSupplyRemark != 'contSupplyRemark'">cont_supply_remark = #{contSupplyRemark},</if>
            <if test="contSupplierName != null and contSupplierName != 'contSupplierName'">cont_supplier_name = #{contSupplierName},</if>
            <if test="payType != null  and payType != ''">pay_type = #{payType},</if>
            <if test="payer != null  and payer != ''">payer = #{payer},</if>
            <if test="payerName != null  and payerName != ''">payer_name = #{payerName},</if>
            <if test="remark != null  and remark != ''">remark = #{remark},</if>
            <if test="deliveryAddress != null and deliveryAddress != ''">delivery_address = #{deliveryAddress},</if>
            <if test="deliveryMobile != null  and deliveryMobile != ''">delivery_mobile = #{deliveryMobile},</if>
            <if test="deliveryRemark != null  and deliveryRemark != ''">delivery_remark = #{deliveryRemark},</if>
            <if test="eta != null">eta = #{eta},</if>
            <if test="etd != null">etd = #{etd},</if>
            <if test="location != null">location = #{location},</if>
            <if test="updateBy != null  and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate
        </trim>
        <where>
            id = #{id}
            <if test="logisticGroupId != null">AND logistic_group_id = #{logisticGroupId}</if>
        </where>
    </update>
    <!--resetShipmentDetailProcessStatus is used for OM reset process status. Not use with another purpose-->
    <update id="resetShipmentDetailProcessStatus" parameterType="ShipmentDetail">
        update shipment_detail
        <trim prefix="SET" suffixOverrides=",">
            process_order_id = null,
            register_no = null,
            <if test="containerNo != null  and containerNo != ''">container_no = #{containerNo},</if>
            <if test="containerStatus != null  and containerStatus != ''">container_status = #{containerStatus},</if>
            <if test="sztp != null  and sztp != ''">sztp = #{sztp},</if>
            <if test="sztpDefine != null  and sztpDefine != ''">sztp_define = #{sztpDefine},</if>
            <if test="temperature != null ">temperature = #{temperature},</if>
            <if test="fe != null  and fe != ''">fe = #{fe},</if>
            <if test="bookingNo != null  and bookingNo != ''">booking_no = #{bookingNo},</if>
            <if test="blNo != null  and blNo != ''">bl_no = #{blNo},</if>
            <if test="sealNo != null  and sealNo != ''">seal_no = #{sealNo},</if>
            <if test="consignee != null  and consignee != ''">consignee = #{consignee},</if>
            <if test="expiredDem != null ">expired_dem = #{expiredDem},</if>
            <if test="detFreeTime != null ">det_free_time = #{detFreeTime},</if>
            <if test="emptyExpiredDem != null ">empty_expired_dem = #{emptyExpiredDem},</if>
            <if test="wgt != null ">wgt = #{wgt},</if>
            <if test="vslName != null  and vslName != ''">vsl_name = #{vslName},</if>
            <if test="vslNm != null  and vslNm != ''">vsl_nm = #{vslNm},</if>
            <if test="voyNo != null  and voyNo != ''">voy_no = #{voyNo},</if>
            <if test="voyCarrier != null  and voyCarrier != ''">voy_carrier = #{voyCarrier},</if>
            <if test="opeCode != null  and opeCode != ''">ope_code = #{opeCode},</if>
            <if test="carrierName != null  and carrierName != ''">carrier_name = #{carrierName},</if>
            <if test="loadingPort != null  and loadingPort != ''">loading_port = #{loadingPort},</if>
            <if test="dischargePort != null  and dischargePort != ''">discharge_port = #{dischargePort},</if>
            <if test="transportType != null  and transportType != ''">transport_type = #{transportType},</if>
            <if test="emptyDepot != null  and emptyDepot != ''">empty_depot = #{emptyDepot},</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''">empty_depot_location = #{emptyDepotLocation},</if>
            <if test="cargoType != null  and cargoType != ''">cargo_type = #{cargoType},</if>
            <if test="commodity != null  and commodity != ''">commodity = #{commodity},</if>
            <if test="vgmChk != null ">vgm_chk = #{vgmChk},</if>
            <if test="vgm != null  and vgm != ''">vgm = #{vgm},</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''">vgm_person_info = #{vgmPersonInfo},</if>
            <if test="customStatus != null  and customStatus != ''">custom_status = #{customStatus},</if>
            <if test="paymentStatus != null  and paymentStatus != ''">payment_status = #{paymentStatus},</if>
            <if test="processStatus != null  and processStatus != ''">process_status = #{processStatus},</if>
            <if test="doStatus != null  and doStatus != ''">do_status = #{doStatus},</if>
            <if test="doReceivedTime != null">do_received_time = #{doReceivedTime},</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''">user_verify_status = #{userVerifyStatus},</if>
            <if test="finishStatus != null  and finishStatus != ''">finish_status = #{finishStatus},</if>
            <if test="status != null ">status = #{status},</if>
            <if test="orderNo != null and orderNo != ''">order_no = #{orderNo},</if>
            <if test="taxCode != null and taxCode != ''">tax_code = #{taxCode},</if>
            <if test="consigneeByTaxCode != null and consigneeByTaxCode != ''">consignee_by_tax_code = #{consigneeByTaxCode},</if>
            <if test="customsNo != null and customsNo != ''">customs_no = #{customsNo},</if>
            <if test="customScanTime != null">custom_scan_time = #{customScanTime},</if>
            <if test="eta != null">eta = #{eta},</if>
            <if test="etd != null">etd = #{etd},</if>
            <if test="remark != null  and remark != ''">remark = #{remark},</if>
            <if test="updateBy != null  and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate
        </trim>
        where id = #{id}
    </update>
    
    <delete id="deleteShipmentDetailById" parameterType="Long">
        delete from shipment_detail where id = #{id}
    </delete>

    <delete id="deleteShipmentDetailByIds" parameterType="String">
        delete from shipment_detail 
        where shipment_id = #{shipmentId}
        AND id in 
        <foreach item="id" collection="shipmentDetailIds" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <select id="selectShipmentDetailByIds" resultMap="ShipmentDetailResult">
        <include refid="selectShipmentDetailVo"/>
        where id in 
        <foreach item="id" collection="shipmentDetailIds" open="(" separator="," close=")">
            #{id}
        </foreach>
        AND logistic_group_id = #{logisticGroupId}

    </select>

    <resultMap id="ShipmentWaitExecResult" type="vn.com.irtech.eport.logistic.dto.ShipmentWaitExec">
    	<result property="processStatus"    column="process_status"    />
  		<collection property="shipmentDetailIds" javaType="ArrayList" 
  			column="{shipmentId=shipment_id,processStatus=process_status}" ofType="java.lang.Long" 
  			select="selectListShipmentDetailWaitExec"/>
	</resultMap>
    
    <select id="selectListShipmentDetailWaitExec" resultType="java.lang.Long">
	  select id
	  from shipment_detail
	  where shipment_id=#{shipmentId} and process_status=#{processStatus}
	</select>

    <select id="selectListShipmentWaitExec" resultMap="ShipmentWaitExecResult">
    	SELECT
			DISTINCT(CONCAT(shipment_id,process_status)),
			shipment_id,
		    process_status
		FROM
		 	shipment_detail
		WHERE user_verify_status = "Y"
			AND (process_status = "E" or process_status = "N")
		ORDER BY process_status
    </select>

    <select id="selectShipmentDetailByProcessIds" resultMap="ShipmentDetailResult">
        <include refid="selectShipmentDetailVo"/>
        where process_order_id in
        <foreach item="processOrderId" collection="array" open="(" separator="," close=")">
            #{processOrderId}
        </foreach>
    </select>

    <!-- <select id="selectSendEmptyShipmentDetailByListCont" resultMap="ShipmentDetailResult">
        <include refid="selectShipmentDetailVo"/>
        where container_no in
        <foreach item="containerNo" collection="array" open="(" separator="," close=")">
            #{containerNo}
        </foreach>
    </select> -->
    <select id="getShipmentDetailListForAssign" parameterType="ShipmentDetail" resultType="ShipmentDetail">
        select id,
        shipment_id as shipmentId,
        logistic_group_id as logisticGroupId,
        process_order_id as processOrderId,
        register_no as registerNo,
        container_no as containerNo,
        container_status as containerNo,
        sztp,
        sztp_define,
        temperature,
        fe,
        booking_no as bookingNo,
        bl_no as blNo,
        seal_no as sealNo,
        consignee,
        expired_dem as expiredDem,
        det_free_time as detFreeTime,
        empty_expired_dem as emptyExpiredDem,
        wgt,
        vsl_name as vslName,
        vsl_nm as vslNm,
        voy_no as voyNo,
        voy_carrier as voyCarrier,
        ope_code as opeCode,
        carrier_name as carrierName,
        loading_port as loadingPort,
        discharge_port as dischargePort,
        transport_type as transportType,
        empty_depot emptyDepot,
        empty_depot_location emptyDepotLocation,
        cargo_type cargoType,
        commodity,
        vgm_chk as vgmChk,
        vgm,
        vgm_person_info as vgmPersonInfo,
        preorder_pickup as preorderPickup,
        pre_pickup_payment_status as prePickupPaymentStatus,
        custom_status as customStatus,
        payment_status as paymentStatus, 
        process_status as processStatus, 
        do_status as doStatus, 
        do_received_time as doReceivedTime,
        user_verify_status as userVerifyStatus, 
        status,
        delivery_address as deliveryAddress, delivery_mobile as deliveryMobile, delivery_remark as deliveryRemark,
        (select remark from pickup_assign where shipment_detail_id = s.id and rownum = 1) as remark,
        create_by as createBy,
        create_time as createTime,
        update_by as updateBy,
        update_time as updateTime,
        (select count(*) from pickup_assign p where p.shipment_detail_id = s.id)as driverAmount
        from shipment_detail s
        <where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerNo != null  and containerNo != ''"> and container_no = #{containerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp = #{sztp}</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="bookingNo != null  and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="blNo != null  and blNo != ''"> and bl_no = #{blNo}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null  and doReceivedTime != ''"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="status != null "> and status = #{status}</if>
        </where>
    </select>

    <select id="selectContainerStatusList" parameterType="ShipmentDetail" resultMap="ShipmentDetailResult">
        select s.bl_no, s.booking_no, s.sztp, s.sztp_define, s.temperature, s.vsl_nm, s.voy_no, s.voy_carrier, s.container_no, s.do_status, s.fe, s.payment_status, s.pay_type, s.payer, s.payer_name, p.service_type as service_type,
        s.create_time, count(a.shipment_detail_id) as assign_number
        from shipment_detail s
            left join process_order p on s.process_order_id = p.id
            left join pickup_assign a on s.id = a.shipment_detail_id
        <where>  
            <if test="logisticGroupId != null "> and s.logistic_group_id = #{logisticGroupId}</if>
            <if test="customStatus != null and customStatus != ''"> and s.custom_status = #{customStatus}</if>
            <if test="paymentStatus != null and paymentStatus != ''"> and s.payment_status = #{paymentStatus}</if>
            <if test="processStatus != null and processStatus != ''"> and s.process_status = #{processStatus}</if>
            <if test="processStatus != null and processStatus != ''"> and s.finish_status = #{finishStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and s.do_status = #{doStatus}</if>
            <if test="serviceType != null"> and p.service_type = #{serviceType}</if>
            <if test="payType != null  and payType != ''"> and p.pay_type = #{payType}</if>
            <if test="params.fromDate != null"> and s.create_time &gt;= to_date(#{params.fromDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="params.toDate != null"> and s.create_time &lt;= to_date(#{params.toDate},'dd/MM/yyyy HH24:mi:ss')</if>
            <if test="containerNo != null  and containerNo != ''"> and (upper(s.container_no) like concat(concat('%', #{containerNo}), '%')</if>
            <if test="sztp != null  and sztp != ''"> or upper(s.sztp) like concat(concat('%', #{sztp}), '%')</if>
            <if test="fe != null  and fe != ''"> or upper(s.fe) like concat(concat('%', #{fe}), '%')</if>
            <if test="bookingNo != null  and bookingNo != ''"> or upper(s.booking_no) like concat(concat('%', #{bookingNo}), '%')</if>
            <if test="blNo != null  and blNo != ''"> or upper(s.bl_no) like concat(concat('%', #{blNo}), '%')</if>
            <if test="vslName != null  and vslName != ''"> or upper(s.vsl_name) like concat(concat('%', #{vslName}), '%')</if>
            <if test="vslNm != null  and vslNm != ''"> or upper(s.vsl_nm) like concat(concat('%', #{vslNm}), '%')</if>
            <if test="voyNo != null  and voyNo != ''"> or upper(s.voy_no) like concat(concat('%', #{voyNo}), '%'))</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> or upper(s.voy_carrier) like concat(concat('%', #{voyCarrier}), '%'))</if>
        </where>
        group by s.bl_no, s.booking_no, s.sztp, s.sztp_define, s.temperature, s.vsl_nm, s.voy_no, s.voy_carrier, s.container_no, s.do_status, s.fe, s.payment_status, s.pay_type, s.payer, s.payer_name, p.service_type, s.create_time
        order by s.create_time desc
    </select>

    <select id="countNumberOfLegalCont" resultType="Integer">
        select count(*) from shipment_detail
        where logistic_group_id = #{logisticGroupId}
        and status > 2
        and id in
        <foreach item="shipmentDetail" collection="shipmentDetails" open="(" separator="," close=")">
            #{shipmentDetail.id}
        </foreach>
    </select>
    <select id="getCommandListInBatch" parameterType="ShipmentDetail" resultType="Long">
	    SELECT PROCESS_ORDER_ID FROM SHIPMENT_DETAIL
		<where>
			<if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
			<if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
			<if test="paymentStatus != null and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
		</where>
		GROUP BY PROCESS_ORDER_ID
    </select>
    <select id="getShipmentDetailForPrint" parameterType="ShipmentDetail" resultType="ShipmentDetail">
		select id, shipment_id as shipmentId, logistic_group_id as logisticGroupId,
		        register_no as registerNo, container_no as containerNo, container_status as containerStatus, sztp, sztp_define as sztpDefine,
		        temperature, fe, booking_no as bookingNo, bl_no as blNo, seal_no as sealNo, consignee, expired_dem as expiredDem, empty_expired_dem as emptyExpiredDem,
		        wgt,location,
		        (vsl_name || ' - ' || voy_carrier) as vslName,
		        vsl_nm as vslNm, voy_no as voyNo, voy_carrier as voyCarrier, ope_code as opeCode, carrier_name as carrierName,
		        loading_port as loadingPort, discharge_port as dischargePort, transport_type as transportType, empty_depot as emptyDepot, empty_depot_location as emptyDepotLocation,
		        CASE
		            WHEN cargo_type = 'AK' THEN 'Over Dimension'
		            WHEN cargo_type = 'BB' THEN 'Break Bulk'
		            WHEN cargo_type = 'BN' THEN 'Bundle'
		            WHEN cargo_type = 'DG' THEN 'Dangerous'
		            WHEN cargo_type = 'DR' THEN 'Reefer and DG'
		            WHEN cargo_type = 'DE' THEN 'Dangerous Empty'
		            WHEN cargo_type = 'FR' THEN 'Fragile'
		            WHEN cargo_type = 'GP' THEN 'General'
		            WHEN cargo_type = 'MT' THEN 'Empty'
		            WHEN cargo_type = 'RF' THEN 'Reefer'
		            ELSE cargo_type
		        END AS cargoType, commodity, 
		        vgm_chk as vgmChk, vgm, vgm_person_info as vgmPersonInfo, preorder_pickup as preorderPickup, pre_pickup_payment_status as prePickupPaymentStatus,
		        custom_status as customStatus, payment_status as paymenStatus, process_status as processStatus, do_status as doStatus, do_received_time as doReceivedTime,
		        user_verify_status as userVerifyStatus, finish_status as finishStatus, status, remark, create_by as createBy, create_time as createTime,
		        delivery_address, delivery_mobile, delivery_remark,
		        update_by as updateBy, update_time as updateTime, process_order_id as processOrderId, order_no as orderNo,
		        (select p.invoice_no from process_bill p where  s.PROCESS_ORDER_ID = p.process_order_id group by p.invoice_no) as invoiceNo,
		        (select p.vat_after_fee from process_bill p where  s.PROCESS_ORDER_ID = p.process_order_id group by p.vat_after_fee) as vatAfterFee
		from shipment_detail s
		<where>  
            <if test="shipmentId != null "> and shipment_id = #{shipmentId}</if>
            <if test="logisticGroupId != null "> and logistic_group_id = #{logisticGroupId}</if>
            <if test="processOrderId != null"> and process_order_id = #{processOrderId}</if>
            <if test="registerNo != null  and registerNo != ''"> and register_no = #{registerNo}</if>
            <if test="containerNo != null  and containerNo != ''"> and container_no = #{containerNo}</if>
            <if test="containerStatus != null  and containerStatus != ''"> and container_status = #{containerStatus}</if>
            <if test="sztp != null  and sztp != ''"> and sztp = #{sztp}</if>
            <if test="temperature != null "> and temperature = #{temperature}</if>
            <if test="fe != null  and fe != ''"> and fe = #{fe}</if>
            <if test="bookingNo != null  and bookingNo != ''"> and booking_no = #{bookingNo}</if>
            <if test="blNo != null  and blNo != ''"> and bl_no = #{blNo}</if>
            <if test="sealNo != null  and sealNo != ''"> and seal_no = #{sealNo}</if>
            <if test="consignee != null  and consignee != ''"> and consignee = #{consignee}</if>
            <if test="expiredDem != null "> and expired_dem = #{expiredDem}</if>
            <if test="detFreeTime != null "> and det_free_time = #{detFreeTime}</if>
            <if test="emptyExpiredDem != null "> and empty_expired_dem = #{emptyExpiredDem}</if>
            <if test="wgt != null "> and wgt = #{wgt}</if>
            <if test="vslName != null  and vslName != ''"> and vsl_name = #{vslName}</if>
            <if test="vslNm != null  and vslNm != ''"> and vsl_nm = #{vslNm}</if>
            <if test="voyNo != null  and voyNo != ''"> and voy_no = #{voyNo}</if>
            <if test="voyCarrier != null  and voyCarrier != ''"> and voy_carrier = #{voyCarrier}</if>
            <if test="opeCode != null  and opeCode != ''"> and ope_code = #{opeCode}</if>
            <if test="carrierName != null  and carrierName != ''"> and carrier_name = #{carrierName}</if>
            <if test="loadingPort != null  and loadingPort != ''"> and loading_port = #{loadingPort}</if>
            <if test="dischargePort != null  and dischargePort != ''"> and discharge_port = #{dischargePort}</if>
            <if test="transportType != null  and transportType != ''"> and transport_type = #{transportType}</if>
            <if test="emptyDepot != null  and emptyDepot != ''"> and empty_depot = #{emptyDepot}</if>
            <if test="emptyDepotLocation != null  and emptyDepotLocation != ''"> and empty_depot_location = #{emptyDepotLocation}</if>
            <if test="cargoType != null  and cargoType != ''"> and cargo_type = #{cargoType}</if>
            <if test="commodity != null  and commodity != ''"> and commodity = #{commodity}</if>
            <if test="vgmChk != null "> and vgm_chk = #{vgmChk}</if>
            <if test="vgm != null  and vgm != ''"> and vgm = #{vgm}</if>
            <if test="vgmPersonInfo != null  and vgmPersonInfo != ''"> and vgm_person_info = #{vgmPersonInfo}</if>
            <if test="preorderPickup != null  and preorderPickup != ''"> and preorder_pickup = #{preorderPickup}</if>
            <if test="prePickupPaymentStatus != null"> and pre_pickup_payment_status = #{prePickupPaymentStatus}</if>
            <if test="customStatus != null  and customStatus != ''"> and custom_status = #{customStatus}</if>
            <if test="paymentStatus != null  and paymentStatus != ''"> and payment_status = #{paymentStatus}</if>
            <if test="processStatus != null  and processStatus != ''"> and process_status = #{processStatus}</if>
            <if test="doStatus != null  and doStatus != ''"> and do_status = #{doStatus}</if>
            <if test="doReceivedTime != null  and doReceivedTime != ''"> and do_received_time = #{doReceivedTime}</if>
            <if test="userVerifyStatus != null  and userVerifyStatus != ''"> and user_verify_status = #{userVerifyStatus}</if>
            <if test="status != null "> and status = #{status}</if>
        </where>
    </select>

    <select id="selectShipmentDetailForDriverShipmentAssign" resultType="vn.com.irtech.eport.logistic.form.PickupAssignForm">
        select sh.id as shipmentDetailId, sh.container_no as containerNo, sh.wgt as wgt, sh.sztp as sztp, a.id as pickupAssignId,
        sh.cargo_type as cargoType
        from shipment_detail sh
        left join pickup_assign a on sh.shipment_id = a.shipment_id
        left join pickup_history p on sh.id = p.shipment_detail_id
        where 
            a.shipment_detail_id is null
            and a.driver_id = #{driverId}
            and sh.shipment_id = #{shipmentId}
            and p.shipment_detail_id is null
            and sh.finish_status = 'N'
            and sh.payment_status = 'Y'
            and a.id is not null
        group by sh.id, sh.container_no, sh.wgt, sh.sztp, sh.cargo_type, a.id, a.create_time 
        order by a.create_time desc
    </select>

    <select id="selectConsigneeTaxCodeByShipmentId" resultType="String" parameterType="Long">
        select tax_code from shipment_detail
        where shipment_id = #{shipmentId}
        fetch next 1 rows only
    </select>

    <select id="selectEdoListByBlNo"  parameterType="String" resultMap="ShipmentDetailResult">
        select container_number as container_no, expired_dem, det_free_time, empty_container_depot as empty_depot, carrier_code as ope_code,
        concat(vessel_no, concat(': ', vessel)) as vsl_nm, vessel as vsl_name, voy_no as voy_carrier, sztp, pol as loading_port, pod as discharge_port,
        tax_code, consignee_by_tax_code
        from edo
        where bill_of_lading = #{blNo} and house_bill_id is null 
    </select>

    <select id="selectHouseBillForShipment" parameterType="String" resultMap="ShipmentDetailResult">
        select e.container_number as container_no, d.expired_dem, d.det_free_time, d.empty_container_depot as empty_depot, 
        d.carrier_code as ope_code, concat(d.vessel_no, concat(': ', d.vessel)) as vsl_nm, d.vessel as vsl_name, d.voy_no as voy_carrier,
        d.sztp, d.pol as loading_port, d.pod as discharge_port, e.consignee2_tax_code as tax_code, e.consignee2 as consignee_by_tax_code,
        e.consignee2 as consignee
        from edo_house_bill e left join edo d on e.edo_id = d.id
        where e.house_bill_no2 is null and e.house_bill_no = #{blNo}
    </select>

    <select id="selectShipmentDetailForDriverSendCont" parameterType="vn.com.irtech.eport.logistic.form.PickupAssignForm" resultType="vn.com.irtech.eport.logistic.form.PickupAssignForm">
        select sh.id as shipmentDetailId, sh.container_no as containerNo, sh.wgt as wgt, sh.sztp as sztp, a.id as pickupAssignId,
        sh.cargo_type as cargoType, sh.consignee as consignee
        from shipment_detail sh
        left join pickup_assign a on sh.shipment_id = a.shipment_id
        left join pickup_history p on sh.id = p.shipment_detail_id
        left join shipment s on sh.shipment_id = s.id
        <where>
            a.shipment_detail_id is null
            and p.shipment_detail_id is null
            and sh.payment_status = 'Y'
            and sh.finish_status = 'N'
            and a.id is not null
            <if test="serviceType != null">and s.service_type = #{serviceType}</if>
            <if test="driverId != null "> and a.driver_id = #{driverId}</if>
            <if test="pickUp.containerNo != null and pickUp.containerNo != ''"> and sh.container_no like concat(concat('%', #{pickUp.containerNo}), '%')</if>
            <if test="pickUp.consignee != null and pickUp.consignee != ''"> and sh.consignee = concat(concat('%', #{pickUp.consignee}), '%')</if>
        </where>
        group by sh.id, sh.container_no, sh.wgt, sh.sztp, sh.cargo_type, sh.consignee, a.id, a.create_time 
        order by a.create_time desc
    </select>

    <update id="updateShipmentDetailByIds">
        update shipment_detail
        <trim prefix="SET" suffixOverrides=",">
            <if test="shipmentDetail.processOrderId != null">process_order_id = #{shipmentDetail.processOrderId},</if>
            <if test="shipmentDetail.registerNo != null  and shipmentDetail.registerNo != ''">register_no = #{shipmentDetail.registerNo},</if>
            <if test="shipmentDetail.containerNo != null  and shipmentDetail.containerNo != ''">container_no = #{shipmentDetail.containerNo},</if>
            <if test="shipmentDetail.containerStatus != null  and shipmentDetail.containerStatus != ''">container_status = #{shipmentDetail.containerStatus},</if>
            <if test="shipmentDetail.sztp != null and shipmentDetail.sztp != ''">sztp = #{shipmentDetail.sztp},</if>
            <if test="shipmentDetail.sztpDefine != null and shipmentDetail.sztpDefine != ''">sztp_define = #{shipmentDetail.sztpDefine},</if>
            <if test="shipmentDetail.temperature != null ">temperature = #{shipmentDetail.temperature},</if>
            <if test="shipmentDetail.fe != null and shipmentDetail.fe != ''">fe = #{shipmentDetail.fe},</if>
            <if test="shipmentDetail.bookingNo != null  and shipmentDetail.bookingNo != ''">booking_no = #{shipmentDetail.bookingNo},</if>
            <if test="shipmentDetail.blNo != null  and shipmentDetail.blNo != ''">bl_no = #{shipmentDetail.blNo},</if>
            <if test="shipmentDetail.sealNo != null and shipmentDetail.sealNo != ''">seal_no = #{shipmentDetail.sealNo},</if>
            <if test="shipmentDetail.consignee != null and shipmentDetail.consignee != ''">consignee = #{shipmentDetail.consignee},</if>
            <if test="shipmentDetail.expiredDem != null ">expired_dem = #{shipmentDetail.expiredDem},</if>
            <if test="shipmentDetail.detFreeTime != null ">det_free_time = #{shipmentDetail.detFreeTime},</if>
            <if test="shipmentDetail.emptyExpiredDem != null ">empty_expired_dem = #{shipmentDetail.emptyExpiredDem},</if>
            <if test="shipmentDetail.wgt != null ">wgt = #{shipmentDetail.wgt},</if>
            <if test="shipmentDetail.vslName != null  and shipmentDetail.vslName != ''">vsl_name = #{shipmentDetail.vslName},</if>
            <if test="shipmentDetail.vslNm != null  and shipmentDetail.vslNm != ''">vsl_nm = #{shipmentDetail.vslNm},</if>
            <if test="shipmentDetail.voyNo != null  and shipmentDetail.voyNo != ''">voy_no = #{shipmentDetail.voyNo},</if>
            <if test="shipmentDetail.voyCarrier != null  and shipmentDetail.voyCarrier != ''">voy_carrier = #{shipmentDetail.voyCarrier},</if>
            <if test="shipmentDetail.opeCode != null  and shipmentDetail.opeCode != ''">ope_code = #{shipmentDetail.opeCode},</if>
            <if test="shipmentDetail.carrierName != null  and shipmentDetail.carrierName != ''">carrier_name = #{shipmentDetail.carrierName},</if>
            <if test="shipmentDetail.loadingPort != null  and shipmentDetail.loadingPort != ''">loading_port = #{shipmentDetail.loadingPort},</if>
            <if test="shipmentDetail.dischargePort != null  and shipmentDetail.dischargePort != ''">discharge_port = #{shipmentDetail.dischargePort},</if>
            <if test="shipmentDetail.transportType != null  and shipmentDetail.transportType != ''">transport_type = #{shipmentDetail.transportType},</if>
            <if test="shipmentDetail.emptyDepot != null  and shipmentDetail.emptyDepot != ''">empty_depot = #{shipmentDetail.emptyDepot},</if>
            <if test="shipmentDetail.emptyDepotLocation != null  and shipmentDetail.emptyDepotLocation != ''">empty_depot_location = #{shipmentDetail.emptyDepotLocation},</if>
            <if test="shipmentDetail.cargoType != null  and shipmentDetail.cargoType != ''">cargo_type = #{shipmentDetail.cargoType},</if>
            <if test="shipmentDetail.commodity != null  and shipmentDetail.commodity != ''">commodity = #{shipmentDetail.commodity},</if>
            <if test="shipmentDetail.vgmChk != null ">vgm_chk = #{shipmentDetail.vgmChk},</if>
            <if test="shipmentDetail.vgm != null  and shipmentDetail.vgm != ''">vgm = #{shipmentDetail.vgm},</if>
            <if test="shipmentDetail.vgmPersonInfo != null  and shipmentDetail.vgmPersonInfo != ''">vgm_person_info = #{shipmentDetail.vgmPersonInfo},</if>
            <if test="shipmentDetail.preorderPickup != null  and shipmentDetail.preorderPickup != ''">preorder_pickup = #{shipmentDetail.preorderPickup},</if>
            <if test="shipmentDetail.prePickupPaymentStatus != null">pre_pickup_payment_status = #{shipmentDetail.prePickupPaymentStatus},</if>
            <if test="shipmentDetail.customStatus != null  and shipmentDetail.customStatus != ''">custom_status = #{shipmentDetail.customStatus},</if>
            <if test="shipmentDetail.paymentStatus != null  and shipmentDetail.paymentStatus != ''">payment_status = #{shipmentDetail.paymentStatus},</if>
            <if test="shipmentDetail.processStatus != null  and shipmentDetail.processStatus != ''">process_status = #{shipmentDetail.processStatus},</if>
            <if test="shipmentDetail.doStatus != null  and shipmentDetail.doStatus != ''">do_status = #{shipmentDetail.doStatus},</if>
            <if test="shipmentDetail.doReceivedTime != null">do_received_time = #{shipmentDetail.doReceivedTime},</if>
            <if test="shipmentDetail.userVerifyStatus != null  and shipmentDetail.userVerifyStatus != ''">user_verify_status = #{shipmentDetail.userVerifyStatus},</if>
            <if test="shipmentDetail.finishStatus != null  and shipmentDetail.finishStatus != ''">finish_status = #{shipmentDetail.finishStatus},</if>
            <if test="shipmentDetail.status != null ">status = #{shipmentDetail.status},</if>
            <if test="shipmentDetail.orderNo != null and shipmentDetail.orderNo != ''">order_no = #{shipmentDetail.orderNo},</if>
            <if test="shipmentDetail.taxCode != null and shipmentDetail.taxCode != ''">tax_code = #{shipmentDetail.taxCode},</if>
            <if test="shipmentDetail.consigneeByTaxCode != null and shipmentDetail.consigneeByTaxCode != ''">consignee_by_tax_code = #{shipmentDetail.consigneeByTaxCode},</if>
            <if test="shipmentDetail.customsNo != null and shipmentDetail.customsNo != ''">customs_no = #{shipmentDetail.customsNo},</if>
            <if test="shipmentDetail.customScanTime != null">custom_scan_time = #{shipmentDetail.customScanTime},</if>
            <if test="shipmentDetail.contSupplyStatus != null and shipmentDetail.contSupplyStatus != ''">cont_supply_status = #{shipmentDetail.contSupplyStatus},</if>
            <if test="shipmentDetail.planningDate != null">planning_date = #{shipmentDetail.planningDate},</if>
            <if test="shipmentDetail.qualityRequirement != null and shipmentDetail.qualityRequirement != ''">quality_requirement = #{shipmentDetail.qualityRequirement},</if>
            <if test="shipmentDetail.contSupplyRemark != null and shipmentDetail.contSupplyRemark != ''">cont_supply_remark = #{shipmentDetail.contSupplyRemark},</if>
            <if test="shipmentDetail.contSupplierName != null and shipmentDetail.contSupplierName != ''">cont_supplier_name = #{shipmentDetail.contSupplierName},</if>
            <if test="shipmentDetail.payType != null  and shipmentDetail.payType != ''">pay_type = #{shipmentDetail.payType},</if>
            <if test="shipmentDetail.payer != null  and shipmentDetail.payer != ''">payer = #{shipmentDetail.payer},</if>
            <if test="shipmentDetail.payerName != null  and shipmentDetail.payerName != ''">payer_name = #{shipmentDetail.payerName},</if>
            <if test="shipmentDetail.remark != null  and shipmentDetail.remark != ''">remark = #{shipmentDetail.remark},</if>
            <if test="shipmentDetail.deliveryAddress != null and shipmentDetail.deliveryAddress != ''">delivery_address = #{shipmentDetail.deliveryAddress},</if>
            <if test="shipmentDetail.deliveryMobile != null  and shipmentDetail.deliveryMobile != ''">delivery_mobile = #{shipmentDetail.deliveryMobile},</if>
            <if test="shipmentDetail.deliveryRemark != null  and shipmentDetail.deliveryRemark != ''">delivery_remark = #{shipmentDetail.deliveryRemark},</if>
            <if test="shipmentDetail.eta != null">eta = #{shipmentDetail.eta},</if>
            <if test="shipmentDetail.etd != null">etd = #{shipmentDetail.etd},</if>
            <if test="shipmentDetail.updateBy != null and shipmentDetail.updateBy != ''">update_by = #{shipmentDetail.updateBy},</if>
            update_time = sysdate
        </trim>
        <where>
            id in 
            <foreach item="id" collection="shipmentDetailIds" open="(" separator="," close=")">
                #{id}
            </foreach>
        </where>
    </update>
</mapper>