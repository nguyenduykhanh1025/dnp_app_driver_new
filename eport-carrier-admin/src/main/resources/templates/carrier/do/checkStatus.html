<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:include="include :: header('Add Carrier Account')" />
    <th:block th:include="include :: datetimepicker-css" />
    <th:block th:include="include :: select2-css" />
</head>

<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-account-add">
            <div class="form-group">
                <label class="col-sm-3 col-xs-3 col-md-3 control-label">Trạng thái nhận DO </label>
                <div id="documentStatus" class="col-sm-3 col-xs-3 col-md-3">
                    <i class='fa fa-toggle-off text-info fa-2x' onclick='clickDocumentStatus()'></i>
                </div>
                <!-- <div class="col-sm-3 col-xs-3 col-md-3">
                    <input class="form-check-input" type="checkbox" id="documentStatus">
                </div> -->
            </div>
            <div class="form-group">
                <label class="col-sm-3 col-xs-3 col-md-3 control-label">Trạng thái làm lệnh </label>
                <div id="status" class="col-sm-3 col-xs-3 col-md-3">
                    <i class='fa fa-toggle-off text-info fa-2x' onclick='clickStatus()'></i>
                </div>
                <!-- <div class="col-sm-3 col-xs-3 col-md-3">
                    <input class="form-check-input" type="checkbox" value="" id="status">
                </div> -->
            </div>
            <div class="form-group">
                <label class="col-sm-3 col-xs-3 col-md-3 control-label">Ghi chú làm lệnh </label>
                <div class="col-sm-3 col-xs-3 col-md-3">
                    <input class="form-check-input" type="text" value="" id="processRemark">
                </div>
            </div>
            <div class="form-group" style="display: flex; justify-content: space-around">
                <button id="buttonSave" type="button" class="btn btn-primary btn-md" onclick="updateDo()">
                    Lưu
                </button>
            </div>
        </form>

    </div>
    <th:block th:include="include :: footer" />
    <th:block th:include="include :: datetimepicker-js" />
    <th:block th:include="include :: select2-js" />
    <script type="text/javascript" th:inline="javascript">
        var equipmentDo = /*[[${equipmentDos}]]*/ ;
        var billOfLading = equipmentDo.billOfLading;
        var status = equipmentDo.status;
        var documentStatus = equipmentDo.documentStatus;
        var disableStatus = false;
        var disableDocStatus = false;
    </script>
    <script type="text/javascript">
        var prefix = "/carrier/admin/do";
        document.addEventListener('DOMContentLoaded', (event) => {

            if (status == 1) {
                //$("#status").prop("disabled", true)
                //$("#status").prop("checked", true)
                $("#status").html("<i class='fa fa-toggle-on text-info fa-2x' onclick='clickStatus()'></i>");
                disableStatus = true;
                $("#doNote").prop("disabled", true)
                $("#processRemark").prop("disabled", true)
                
            }

            if (documentStatus == 1) {
                //$("#documentStatus").prop("disabled", true)
                //$("#documentStatus").prop("checked", true)
                $("#documentStatus").html("<i class='fa fa-toggle-on text-info fa-2x' onclick='clickDocumentStatus()'></i>");
                disableDocStatus = true;
            }

            if (status == 1 && documentStatus == 1) {
                $("#buttonSave").prop("disabled", true);
            }


        });

        function updateDo() {
            // if ($('#status').is(":checked")) {
            //     $("#status").val(1)
            // }
            // if ($('#documentStatus').is(":checked")) {
            //     $("#documentStatus").val(1)
            // }
            //var status = $("#status").val();
            var doNote = $("#doNote").val();
            var processRemark = $("#processRemark").val();
            //var documentStatus = $("#documentStatus").val();
            $.ajax({
                url: prefix + "/updateDoStatus",
                method: "post",
                data: {
                    billOfLading: billOfLading,
                    status: status,
                    processRemark : processRemark,
                    doNote: doNote,
                    documentStatus: documentStatus
                },
            }).done(function (result) {
               if(result.code == 0)
               {
                    $.modal.msgSuccess("Cập nhật thành công !");
                    setTimeout(function(){
                        parent.reload()
                    }, 1000);
               } else {
                    $.modal.msgError("Cập nhật không thành công !, liên hệ Admin để biết thêm chi tiết");
                        setTimeout(function(){
                        
                    }, 1000);
               }
            });
        }

        function clickStatus() {
            if (!disableStatus) {
                if (status == 1) {
                    status = 0;
                    $("#status").html("<i class='fa fa-toggle-off text-info fa-2x' onclick='clickStatus()'></i>");
                } else {
                    status = 1;
                    $("#status").html("<i class='fa fa-toggle-on text-info fa-2x' onclick='clickStatus()'></i>");
                }
            }
        }

        function clickDocumentStatus() {
            if (!disableDocStatus) {
                if (status == 1) {
                    documentStatus = 0;
                    $("#documentStatus").html("<i class='fa fa-toggle-off text-info fa-2x' onclick='clickDocumentStatus()'></i>");
                } else {
                    documentStatus = 1;
                    $("#documentStatus").html("<i class='fa fa-toggle-on text-info fa-2x' onclick='clickDocumentStatus()'></i>");
                }
            }
        }
    </script>
</body>

</html>